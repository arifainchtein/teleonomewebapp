
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="favicon.ico">

<title>Teleonome</title>

<!-- Bootstrap core CSS -->
<link href="bootstrap.min.css" rel="stylesheet">
<link href="bs/css/bootstrap-switch.css" rel="stylesheet">
<link href="css/UpdateParams.css" rel="stylesheet">
<link href="css/SearchPanel.css" rel="stylesheet">



<style>
.top-buffer {
	margin-top: 20px;
}

.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2,
	.col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3,
	.col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5,
	.col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6,
	.col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8,
	.col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9,
	.col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11,
	.col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12
	{
	padding-left: 5px;
	padding-right: 5px;
}

.panel-heading.row {
	margin: 0;
	padding-left: 0;
	padding-right: 0;
}

@media ( max-width :767px) {
	h5, .h5 {
		font-size: 16px;
	}
}

@media ( min-width :768px) {
	.panel-heading h6 {
		font-size: 1.5em;
	}
}

@media ( min-width :992px) {
}

@media ( min-width :1200px) {
}

/* Sticky footer styles
-------------------------------------------------- */
html, body {
	height: 100%;
	/* The html and body elements cannot have any padding or margin. */
}

/* Wrapper for page content to push down footer */
#wrap {
	min-height: 100%;
	height: auto !important;
	height: 100%;
	/* Negative indent footer by its height */
	margin: 0 auto -60px;
	/* Pad bottom by footer height */
	padding: 0 0 60px;
}

/* Set the fixed height of the footer here */
#footer {
	height: 60px;
	background-color: white;
}

/* Custom page CSS
-------------------------------------------------- */
/* Not required for template or sticky footer method. */
#wrap>.container {
	padding: 10px 15px 0;
}

#footer>.container {
	padding-left: 15px;
	padding-right: 15px;
}

.navbar-header {
	float: none;
	width: 100%;
	padding: 10px;
}

.navbar-brand {
	font-size: 20pt;
	float: none;
}

#bottomNav {
	padding: 10px;
	background-color: black;
}

#bottomNav a {
	font-size: 10pt;
	color: white;
	text-decoration: none;
}

#bottomNav a:hover {
	color: #fff;
}

/*
for chart
*/
path {
	stroke: steelblue;
	stroke-width: 2;
	fill: none;
}

.magentaline {
	stroke: magenta;
}

.cyanline {
	stroke: cyan;
}

.greenline {
	stroke: green;
}

.blueline {
	stroke: blue;
}

.redline {
	stroke: red;
}

.violetline {
	stroke: blueviolet;
}

.orangeline {
	stroke: orange;
}

.yellowline {
	stroke: yellow;
}

.axis path, .axis line {
	fill: none;
	stroke: grey;
	stroke-width: 1;
	shape-rendering: crispEdges;
}

input:invalid {
	border: 1px solid red;
}

input:valid {
	border: 1px solid green;
}

@media screen and (min-width: 768px) {
	.modal-xl {
		width: 90%;
	}
	#WaitingWheel {
		margin-left: 350px;
		margin-top: 130px;
	}
}

.glyphicon.glyphicon-signal, .glyphicon.glyphicon-tasks, .glyphicon.glyphicon-info-sign,
	.glyphicon.glyphicon-dashboard, .glyphicon.glyphicon-flash, .glyphicon.glyphicon-time,
	.glyphicon.glyphicon-off {
	font-size: 20px;
	margin-top: -25px;
}

.label {
	font-size: 45%;
}

.SettingsSubMenu {
	cursor: pointer;
}

.SettingsMenu {
	cursor: pointer;
}

.SettingBar {
	text-align: center;
}

.SettingBar:hover {
	color: salmon;
}

.DiagnosticsMenu {
	cursor: pointer;
}

.DiagnosticsBar {
	text-align: center;
}

.DiagnosticsBar:hover {
	color: salmon;
}

#WaitingText {
	margin-left: 50px;
	margin-top: -30px;
	margin-bottom: 10px;
	font-size: 22px;
}

#WaitingWheel {
	display: none;
	background-color: #B6B6B4;
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	border-radius: 5px;
	padding: 20px;
	margin-left: 50px;
	margin-top: 10px;
	z-index: 10;
	width: 300px;
	height: 80px;
}

body.modal-open .modal {
	display: flex !important;
	height: 100%;
}

body.modal-open .modal .modal-dialog {
	margin: auto;
}

/*
 Internal Power css
*/
.battery:after {
	background-color: #fff;
	border: 2px solid #000;
	content: "";
	display: block;
	height: 16px;
	position: absolute;
	right: -6px;
	top: 6px;
	width: 6px;
}

.battery {
	background-color: #fff;
	border: 2px solid #000;
	height: 32px;
	margin-left: auto;
	margin-right: auto;
	position: relative;
	width: 100px;
	font-size: 24px;
	font-family: Courier;
	color: Black;
}

.battery .battery-level {
	background-color: #666;
	height: 100%;
}

.battery .battery-level.battery-high {
	background-color: #66CD00;
}

.battery .battery-level.battery-medium {
	background-color: #FCD116;
}

.battery .battery-level.battery-low {
	background-color: #FF3333;
}

.battery .battery-level {
	text-align: center;
}

/*
the css for the little box on the top right f external data
*/
.externalDataStatusBox {
	width: 30px;
	height: 30px;
}

.external-data-danger {
	background: rgb(255, 0, 0);
}

.external-data-success {
	background: rgb(0, 255, 0);
}

.external-data-warning {
	background: rgb(255, 255, 0);
}

.external-data-stale {
	background: rgb(148, 0, 211);
}

.panel-default>.panel-heading-danger {
	background: rgb(255, 0, 0);
}

.panel-default>.panel-heading-warning {
	background: rgb(255, 255, 0);
}

.panel-default>.panel-heading-success {
	background: rgb(0, 255, 0);
}

.panel-default>.panel-heading-stale {
	background: rgb(224, 176, 255);
}
</style>
</head>

<body>


	<div class="container">

		<div class="container-fluid">
			<div class="row">
				<div id="status" class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<h3>
						<div class="text-center" style="padding-left: 5px;"
							id="teleonomeName">Connecting....</div>
					</h3>
				</div>
			</div>
		</div>

		<div class="row">
			<div id="WaitingWheel" class="col-xs-6 col-lg-2 col-*-offset-2">
				<img src="130.gif"/ >
				<div id="WaitingText">In Pulse...</div>
			</div>
		</div>


		<div id="Pathology"
			class="col-lg-3 col-md-3 col-sm-2 col-xs-2 label label-lg label-danger text-white top-buffer"
			style="display: none;">
			<h5>
				<span id="ErrorText" style="color: white;"></span>
			</h5>
		</div>

		<div class="row collapse">
			<div id="CommandRequestStatus" class="alert alert-info"></div>
		</div>

		<div id="PulseActivityPanel" class="row">
			<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-xs-offset-1">

				<table>
					<tr>
						<td id="TeleonomeDataStatus"
							class=" label label-sm label-danger collapse"
							style="display: none; height: 20px; margin-right: 10px;"></td>
						<td>&nbsp;</td>
						<td id="TeleonomeStatus"
							class=" label label-sm label-danger collapse"
							style="display: none; height: 20px;"></td>
					</tr>
					<tr>
						<td style="padding-right: 10px;"><h6>&nbsp;Data&nbsp;</h6></td>
						<td>&nbsp;</td>
						<td><h6>Status</h6></td>
					</tr>
					<!--
					<tr><td colspan="3" id="PulseStatusInfo" ></td></tr>
					-->

				</table>
				<div id="PulseStatusInfo"></div>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-*-offset-1">
				<table>
					<tr>
						<td><b>Last Pulse</b></td>
					</tr>
					<tr>
						<td><b><span id="PulseTimestamp"></span></b></td>
					</tr>
					<!--
						<tr><td>&nbsp;<b><span id="PulseCreationTime"></span></b></td></tr>
						<tr><td>&nbsp;<b><span id="WPSInfo"></span></b></td></tr>
						<tr><td><span id="PulseStatusInfo" ></span><br><span id="PulseStatusInfoSecundary" ></span></td></tr>
					-->

				</table>
			</div>

			<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 col-*-offset-1">
				<strong><h5>
						<span id="TimeSinceLastPulse"></span>
						<h5></strong>

			</div>
		</div>

		<div class="row">
			<div style="display: none;"
				class="col-lg-12 col-md-12 col-sm-12 col-sm-12 col-xs-12 text-center">
				<div id="ErrorMessage" class="alert alert-danger"></div>
			</div>
		</div>

		<div class="modal fade" id="telepathon-graph-modal" tabindex="-1">
			<div class="modal-dialog modal-lg">
			  <div class="modal-content">
				<div class="modal-header">
				  <h5 class="modal-title" id="">Data Visualization</h5>
				  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
				  <div id="telepathon-graph"></div>
				</div>
			  </div>
			</div>
		  </div>

		<!--


		<div class="modal fade" id="CodeInputModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header text-center">
							<h4 id="CodeInputModalTitle" class="modal-title w-100 font-weight-bold"></h4>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
							<h5 id="CodeInputModalDescription" class="modal-title w-100 font-weight-bold"></h5>
						</div>
						<div class="modal-body mx-3">
							<div class="md-form mb-5">
								<i class="fa fa-envelope prefix grey-text"></i>
								<input type="text" id="code" class="form-control validate">
								<label data-error="wrong" data-success="right" for="defaultForm-email">Code</label>
							</div>
						</div>
						<div class="modal-footer d-flex justify-content-center">
							<button id="ModalButonText" class="btn btn-default"></button>
						</div>
					</div>
				</div>
			</div>
			
-->
		<div id="OrganismModal"></div>
		<div id="EntryPoint" class="container-fluid"></div>
		<div id="Graph"></div>


		<div id="footer">
			<div class="col-xs-12 navbar-default navbar-fixed-bottom">
				<div class="row" id="bottomNav"></div>
			</div>
		</div>

		<script type="text/javascript" src="jquery-2.2.0.min.js"></script>
		<script type="text/javascript" src="bootstrap.min.js"></script>
		
		 <script src="//d3js.org/d3.v7.min.js"></script>
		 
		 <!-- 
		<script type="text/javascript" src="d3.v3.min.js"></script>
 -->
		<script type="text/javascript" src="mqttws31.min.js"></script>


		<script type="text/javascript" src="TeleonomeConstants.js"></script>
		<script type="text/javascript" src="bs/js/bootstrap-switch.js"></script>

		<script type="text/javascript" src="HashMap.js"></script>
		<script type="text/javascript" src="Identity.js"></script>
		<script type="text/javascript" src="D3Chart.js"></script>
		<script type="text/javascript" src="CSVMultiLineChart.js"></script>
		<!-- Make sure that LocalStorageManager.js is loaded before the SearchFunctions.js -->
		<script type="text/javascript" src="LocalStorageManager.js"></script>
		<!-- Make sure that SearchFunctions.js.js is loaded before the GeneralFunctions.js -->
		<script type="text/javascript" src="SearchFunctions.js"></script>
		<script type="text/javascript" src="ViewManager.js"></script>
		<!-- Make sure that GeneralFunctions.js is loaded before the DenomeFunctions.js -->
		<script type="text/javascript" src="GeneralFunctions.js"></script>
		<!-- Make sure that DenomeFunctions.js is loaded before the templates -->
		<script type="text/javascript" src="DenomeFunctions.js"></script>
		<!-- The templates, make sure they are loaded after the two Functions files -->
		<script type="text/javascript" src="templates/SettingsInfo.js"></script>
		<script type="text/javascript" src="templates/DiagnosticsInfo.js"></script>
		<script type="text/javascript" src="templates/SystemDiagnostics.js"></script>
		<script type="text/javascript"
			src="templates/AsynchronousDiagnostics.js"></script>
		<script type="text/javascript"
			src="templates/SynchronousDiagnostics.js"></script>
		<script type="text/javascript" src="templates/DeneWordTable.js"></script>
		<script type="text/javascript" src="templates/DeviceInfo.js"></script>
		<script type="text/javascript" src="templates/Networking.js"></script>
		<script type="text/javascript" src="templates/UpdateParams.js"></script>
		<script type="text/javascript" src="templates/WellSingleValuePanel.js"></script>
		<script type="text/javascript" src="templates/DailyWeatherForecast.js"></script>
		<script type="text/javascript"
			src="templates/ShortTermWeatherForecast.js"></script>
		<script type="text/javascript"
			src="templates/NewRememberedDeneWordWizard.js"></script>
		<script type="text/javascript" src="templates/MnemosyneTable.js"></script>
		<script type="text/javascript"
			src="templates/SingleValuePanelExternalData.js"></script>
		<script type="text/javascript" src="templates/SingleValuePanel.js"></script>
		<script type="text/javascript"
			src="templates/SingleValuePanelExternalTimestamp.js"></script>
		<script type="text/javascript" src="templates/PathologyPanel.js"></script>
		<script type="text/javascript"
			src="templates/CompleteDeneSingleValuePanel.js"></script>
		<script type="text/javascript"
			src="templates/CompleteDeneSingleValuePanelExternalData.js"></script>
		<script type="text/javascript"
			src="templates/ActionEvaluationReport.js"></script>
		<script type="text/javascript"
			src="templates/NetworkSensorDeviceStatusReport.js"></script>
		<script type="text/javascript" src="templates/OrganismView.js"></script>
		<script type="text/javascript" src="templates/TelepathonPanel.js"></script>
		<script type="text/javascript" src="templates/SearchPanel.js"></script>
		<script type="text/javascript" src="templates/Mnemosycons.js"></script>
		<script type="text/javascript" src="templates/DenomeAnalysis.js"></script>

		<!-- The templates, make sure RenderingEngine is loaded after all the templates -->
		<script type="text/javascript" src="RenderingEngine.js"></script>
		<!-- The Heart Communication is tbe the last one to be loaded -->
		<script type="text/javascript" src="HeartComms.js"></script>

		<script>
		 var liveUpdate;
	     var search_RefreshInterval;
	     var search_RefreshCounterInterval;
	     var refreshCounter=30;
	     var refreshCounterStatus=true;
		 var hasWlan0;
		 var hasWlan1;
		 var hasEth0;
		 var powerButtonDisabled=false;
		 var powerButtonRed=false;
	     var localStorageManager;
		 var searchFunctions;
		 var viewManager;
		 var newRememberedDeneWordTeleonomeName="";
		 var newRememberedDeneWordNucleus="";
		 var newRememberedDeneWordDeneChain="";
		 var newRememberedDeneWordDene="";
		 var newRememberedDeneWordDeneWord="";
		 var refreshActive=true;
		 var systemDiagnosticsPanelPointer;
		 
			$(document).ready(function() {
				
				$('#WaitingText').html("Please Wait2");
				$('#WaitingWheel').show();

				localStorageManager = new LocalStorageManager();
				searchFunctions = new SearchFunctions();
				viewManager = new ViewManager();
				HeartConnect();
				
				$.ajax({
					type: "GET",
					url: "/TeleonomeServlet",
					data: {formName:"GetNetworkInterfaces" },
					success: function (interfaces) {
					// var interfaces = JSON.parse(data);
						 hasWlan0=interfaces.hasOwnProperty("wlan0");
						 hasWlan1=interfaces.hasOwnProperty("wlan1");
						 hasEth0=interfaces.hasOwnProperty("eth0");
					},
					error: function(data){
						$('#WaitingWheel').hide();
						console.log("error getting Network Interfaces Info:" + JSON.stringify(data));
						alert("error getting Network Interfaces Info:" + JSON.stringify(data));
						return false;
					}
				});
		

				//
				// before we actually connect ask the server for the visualizer
				//	
				$(document).on("click", '.pathology-log-link', function(e) {
					e.preventDefault();
					var ref = this.getAttribute('href');
					$('.pathology-modal-body').html("");
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"GetLogFile", logFileName:ref},
						success: function (data) {
							console.log("data=" + data);
							$('.pathology-modal-body').html(data);
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on("click", ".dismissbannerformmodal", function () {
					if(refreshInterfaceAfterModalNeeded){
						refreshInterfaceAfterModalNeeded=false;
						RefreshInterface();
					}
				});
				
				
                $(document).on("click", ".pathology-showLogsLink", function () {
                    var dirName = $(this).attr("data-dirname");
                    
                    
                    
                    $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"GetLogFileNames", dirName:dirName},
						success: function (data) {
							console.log("data=" + data);
							
							$(".pathology-file-list").empty(); 
							var array =  data.split(",");
							var arrayLength = array.length;
							for (var i = 0; i < arrayLength; i++) {
							    $(".pathology-file-list").append('<li><a href=\"logs/'+ dirName + '/'+array[i]+'.txt\" class=\"pathology-log-link\" id=\"'+array[i]+'\">'+ array[i] +'</a></li>');   
							}
							
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
                    
                   
                  
                });
				
                
            
                
                var untilDate = new Date();
                var fromDate = new Date();
                fromDate.setDate(fromDate.getDate()-1);
                var currentTimeAsString = untilDate.getHours() + ":" + untilDate.getMinutes() + ":"  + untilDate.getSeconds();
            
                $("#fromDate").valueAsDate = fromDate;
                $("#fromTime").defaultValue = currentTimeAsString;
            
                $("#untilDate").valueAsDate = untilDate;
                $("#untilTime").defaultValue = currentTimeAsString;
                $('#WaitingWheel').hide(); 
            
                $(document).on('click', "#NewChart",function(e) {
                    e.preventDefault();
                    $("#TopButtons").hide();
                    refreshCounterStatus=false;
                    $("#RefreshCounter").hide();
					 $("#RefreshCounterMessage").hide();
					 refreshActive=false;
					searchFunctions.loadNewVisualizerData();
					$(".BSswitch").bootstrapSwitch();
                    $("#SearchConfigurator").show();
                    
                });
                $(document).on('click', "#ExportViewData",function(e) {
                    e.preventDefault();
                   
					searchFunctions.exportAllGraphs();
                    
                });
                
                
                $(document).on('click', "#CancelSearch",function(e) {
                    e.preventDefault();
                    $("#SearchConfigurator").hide();
                    $("#TopButtons").show();
                    $("#RefreshCounter").show();
					 $("#RefreshCounterMessage").show();
					 refreshActive=true;
                    refreshCounterStatus=true;
                });
                
                
                $(document).on('click', "#ClearCharts",function(e) {
                    e.preventDefault();
                   
                    localStorageManager.removeComponentInfo(LOCAL_STORAGE_SEARCH_KEY);
                    $("#RefreshCounter").html("");
                    $("#SearchGraphArea").empty();
                    refreshCounterStatus=false;
                    searchFunctions.refreshSearchPage();
				});

				//
				// telepathon functions
				//
				$(document).on('click', ".telepathon-daily-value",function(e) {
					e.preventDefault();
					//$('#NewRememberedWordDeneWordView').empty();
					var telepathonName = $(this).data("telepathonname");
					var deneName = $(this).data("denename");
					var deneWordName = $(this).data("denewordname");

					//some code
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"GetTelepathonDataValueByPeriod", telepathonName:telepathonName, deneName:deneName, deneWordName:deneWordName},
						success: function (res) {
							var data = JSON.parse(res);
							console.log(data);
							$('#telepathon-graph-modal').modal('show');
							showTelepathonGraph(data);

						},
						error: function(data){
							$("#NewRememberedWordPanel").hide();
							refreshActive=true;
							RefreshInterface();
							console.log("error getting denes :" + JSON.stringify(data));
							alert("Error getting denes:" + JSON.stringify(data));
							return false;
						}
					});
				});
				//
				// end of telepathon functiopns
				//



				//
				// functions for the new rememberedword functionality
				//
				$(document).on('click', "#NewRemember",function(e) {
                    e.preventDefault();                   
                    //var newRememberedDeneWordWizard = new NewRememberedDeneWordWizard();
					//var orgSelectorHTML = newRememberedDeneWordWizard.process();
					//$("#OrganismModal").empty();
					//$("#OrganismModal").append(orgSelectorHTML);
					//
					// initialie the variables
					// 
					$("#NewRememberedWordPanel").show();
					refreshActive=false;
					newRememberedDeneWordTeleonomeName="";
					 newRememberedDeneWordNucleus="";
					 newRememberedDeneWordDeneChain="";
					 newRememberedDeneWordDene="";
					 newRememberedDeneWordDeneWord="";
					$("#NewRememberedWordOrganismView").empty();
					$("#NewRememberedWordNucleusView").empty();
					$("#NewRememberedWordDeneChainView").empty();
					$("#NewRememberedWordDeneView").empty();
					$("#NewRememberedWordDeneWordView").empty();
					$("#ModalHeadingText").html("Select Teleonome");
					 //
					//  now populate the teleonomes
					//
					$("#RefreshCounter").html("");
					refreshCounterStatus=false;
					var panelHTML="";

					panelHTML += "<div class=\"col-lg-2 col-md-2 col-sm-2 col-xs-6 text-center top-buffer\">";
					panelHTML += "<a href=\"http://"+i+".local\" data-teleonomename=\""+ teleonomeName +"\" class=\"btn btn-lg btn-success rwTeleonome\">"+teleonomeName+"</a>";
					panelHTML += "</div>";	
					if(organismInfoJsonData != undefined){
						for(var i in organismInfoJsonData){
							
							panelHTML += "<div class=\"col-lg-2 col-md-2 col-sm-2 col-xs-6 text-center top-buffer\">";
							panelHTML += "<a href=\"http://"+i+".local\" data-teleonomename=\""+ i +"\" class=\"btn btn-lg btn-"+ organismInfoJsonData[i] +" rwTeleonome\">"+i+"</a>";
							panelHTML += "</div>";	
							
						}
					}
					$('#NewRememberedWordOrganismView').append(panelHTML);
				});

				$(document).on('change','#RememeberedDeneWords',function(){
					if( this.value!="" ){
						$("#ForgetSubmitButton").prop('disabled', false);
					}else{
						$("#ForgetSubmitButton").prop('disabled', true);
					}
				});

				$(document).on('click', "#ForgetRememberedDeneWord",function(e) {
                    e.preventDefault();                   
                   
					$("#ForgetRememberedWordPanel").show();
					refreshActive=false;
					
					$("#ForgetHeadingText").html("Select DeneWord to Stop Remembering");
					$('#RememberedDeneWordList').empty(); 
					
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"GetRememberedDeneWordList"},
						success: function (list) {
							console.log("GetRememberedDeneWordList, list=" + list);
							var l = JSON.parse(list);
							console.log(l);
							var $el = $("#RememeberedDeneWords");
							$el.append($("<option></option>").attr("", val).text("Select"));
							for(var i in l){
								var key = i;
								var val = l[i];
								console.log(val);
								$el.append($("<option></option>").attr("value", key).text(key));
							}
							// var arrayLength = list.length;
							// var panelHTML="";
							// for (var i = 0; i < list; i++) {
							// 	panelHTML += "<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-6 text-center top-buffer\">";
							// 	panelHTML += "<a href=\"http://"+i+".local\" data-dene=\""+ list[i] +"\" class=\"btn btn-lg btn-default rwDene\">"+deneArray[i]+"</a>";
							// 	panelHTML += "</div>";	
							// }
							// $('#NewRememberedWordDeneView').append(panelHTML);
						},
						error: function(data){
							console.log("error getting denes :" + JSON.stringify(data));
							alert("Error getting denes:" + JSON.stringify(data));
							return false;
						}
					});
					
				});
				
				$(document).on('click', "#ForgetSubmitButton",function(e) {
					e.preventDefault();        
					var $el = $("#RememeberedDeneWords");
					var selectedValue = $("#RememeberedDeneWords option:selected").val();           
					$("#ForgetRememberedWordPanel").hide();
					 
					var passwd = prompt("Are you sure you want to stop remembering " + selectedValue + "  ? Please enter the code", "");
					if(passwd == null)return false;

					  if(isNaN(passwd)){
						alert("Code must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Code must be 6 numbers");
						  return false;
					  }
					
					//some code
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"StopRemembering", Identity: selectedValue, CommandCode:passwd},
						
						success: function (data) {
							alert("Request Sent");
						},
						error: function(data){
							console.log("error StopRemembering :" + JSON.stringify(data));
							alert("Error StopRemembering :" + JSON.stringify(data));
							return false;
						}
					});
					refreshActive=true;
					RefreshInterface();
				});


				$(document).on('click', "#ForgetRememberedWordCloseButton",function(e) {
                    e.preventDefault();                   
					$("#ForgetRememberedWordPanel").hide();
					refreshActive=true;
					RefreshInterface();
				});


				$(document).on('click', "#NewRememberedWordCloseButton",function(e) {
                    e.preventDefault();                   
					$("#NewRememberedWordPanel").hide();
					refreshActive=true;
					RefreshInterface();
				});

				$(document).on('click', ".rwTeleonome",function(e) {
					e.preventDefault();
					
					newRememberedDeneWordTeleonomeName = $(this).data("teleonomename");
					$("#ModalHeadingText").html("Select Nucleus");
					$("#NewRememberedWordIdentity").html("<h4>@" + newRememberedDeneWordTeleonomeName + "</h4>");

					$('#NewRememberedWordOrganismView').empty();
					var panelHTML="";
					var nucleusArray = ["Internal","Purpose", "Mnemosyne"];
					var arrayLength = nucleusArray.length;
					for (var i = 0; i < arrayLength; i++) {
						panelHTML += "<div class=\"col-lg-3 col-md-3 col-sm-3 col-xs-6 text-center top-buffer\">";
						panelHTML += "<a href=\"http://"+i+".local\" data-nucleus=\""+ nucleusArray[i] +"\" class=\"btn btn-lg btn-default rwNucleus\">"+nucleusArray[i]+"</a>";
						panelHTML += "</div>";	
					}
					$('#NewRememberedWordNucleusView').append(panelHTML);
    	           
				});
				
				$(document).on('click', ".rwNucleus",function(e) {
					e.preventDefault();
					$('#NewRememberedWordNucleusView').empty();
					newRememberedDeneWordNucleus = $(this).data("nucleus");
					

					var screensize = document.documentElement.clientWidth;
        			if(screensize>500){
						$("#NewRememberedWordIdentity").html("<h4>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus + "</h4>");
					}else{
						$("#NewRememberedWordIdentity").html("<h5>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus + "</h5>");
					}

					$("#ModalHeadingText").html("Select DeneChain");
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"GetDeneChainNames", TeleonomeName: newRememberedDeneWordTeleonomeName,Nucleus:newRememberedDeneWordNucleus},
						success: function (deneChainArray) {
							console.log("deneChainArray=" + deneChainArray);
							var panelHTML="";
							var arrayLength = deneChainArray.length;
							for (var i = 0; i < arrayLength; i++) {
								panelHTML += "<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-12 text-center top-buffer\">";
								panelHTML += "<a href=\"http://"+i+".local\" data-denechain=\""+ deneChainArray[i] +"\" class=\"btn btn-lg btn-default rwDeneChain\">"+deneChainArray[i]+"</a>";
								panelHTML += "</div>";	
							}
							$('#NewRememberedWordDeneChainView').append(panelHTML);
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});
				});

				$(document).on('click', ".rwDeneChain",function(e) {
					e.preventDefault();
					$('#NewRememberedWordDeneChainView').empty();
					newRememberedDeneWordDeneChain = $(this).data("denechain");
					var screensize = document.documentElement.clientWidth;
        			if(screensize>500){
						$("#NewRememberedWordIdentity").html("<h4>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus +":" + newRememberedDeneWordDeneChain + "</h4>");
					}else{
						$("#NewRememberedWordIdentity").html("<h6>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus +":" + newRememberedDeneWordDeneChain + "</h6>");
					}
					$("#ModalHeadingText").html("Select Dene");
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"GetDeneNames", TeleonomeName: newRememberedDeneWordTeleonomeName,Nucleus:newRememberedDeneWordNucleus, DeneChain:newRememberedDeneWordDeneChain},
						success: function (deneArray) {
							console.log("deneArray=" + deneArray);
							var arrayLength = deneArray.length;
							var panelHTML="";
							for (var i = 0; i < arrayLength; i++) {
								panelHTML += "<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-12 text-center top-buffer\">";
								panelHTML += "<a href=\"http://"+i+".local\" data-dene=\""+ deneArray[i] +"\" class=\"btn btn-lg btn-default rwDene\">"+deneArray[i]+"</a>";
								panelHTML += "</div>";	
							}
							$('#NewRememberedWordDeneView').append(panelHTML);
						},
						error: function(data){
							console.log("error getting denes :" + JSON.stringify(data));
							alert("Error getting denes:" + JSON.stringify(data));
							return false;
						}
					});
				});

				$(document).on('click', ".rwDene",function(e) {
					e.preventDefault();
					$('#NewRememberedWordDeneView').empty();
					newRememberedDeneWordDene = $(this).data("dene");
					$("#ModalHeadingText").html("Select DeneWord");
					var screensize = document.documentElement.clientWidth;
					if(screensize>500){
						$("#NewRememberedWordIdentity").html("<h4>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus +":" + newRememberedDeneWordDeneChain + ":" + newRememberedDeneWordDene + "</h4>");
					}else{
						$("#NewRememberedWordIdentity").html("<h6>@" + newRememberedDeneWordTeleonomeName + ":" + newRememberedDeneWordNucleus +":" + newRememberedDeneWordDeneChain + ":" + newRememberedDeneWordDene + "</h6>");
					}
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"GetDeneWordNamesForNewRememberedWord", TeleonomeName: newRememberedDeneWordTeleonomeName,Nucleus:newRememberedDeneWordNucleus, DeneChain:newRememberedDeneWordDeneChain, Dene:newRememberedDeneWordDene},
						success: function (deneWordsArray) {
							console.log("deneWordsArray=" +deneWordsArray);
							var arrayLength = deneWordsArray.length;
							var panelHTML="";
							if(arrayLength>0){
								for (var i = 0; i < arrayLength; i++) {
									panelHTML += "<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-12 text-center top-buffer\">";
									panelHTML += "<a href=\"http://"+i+".local\" data-deneword=\""+ deneWordsArray[i] +"\" class=\"btn btn-lg btn-default rwDeneWord\">"+deneWordsArray[i]+"</a>";
									panelHTML += "</div>";	
								}
							}else{
								panelHTML += "<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-12 text-center top-buffer\">";
									panelHTML += "No DeneWords Available";
									panelHTML += "</div>";
							}
							$('#NewRememberedWordDeneView').append(panelHTML);
						},
						error: function(data){
							console.log("error getting denes :" + JSON.stringify(data));
							alert("Error getting denes:" + JSON.stringify(data));
							return false;
						}
					});
				});

				$(document).on('click', ".rwDeneWord",function(e) {
					e.preventDefault();
					$('#NewRememberedWordDeneWordView').empty();
					newRememberedDeneWordDeneWord = $(this).data("deneword");

					var newRememberedDeneWordIdentity = "@" + newRememberedDeneWordTeleonomeName +":"+ newRememberedDeneWordNucleus + ":" + newRememberedDeneWordDeneChain + ":" + newRememberedDeneWordDene + ":"+ newRememberedDeneWordDeneWord;
					 
					var passwd = prompt("Are you sure you want to start remembering " + newRememberedDeneWordIdentity + "  ? Please enter the code", "");
					if(passwd == null)return false;

					  if(isNaN(passwd)){
						alert("Code must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Code must be 6 numbers");
						  return false;
					  }
					
					//some code
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:"StartRemembering", Identity: newRememberedDeneWordIdentity, CommandCode:passwd},
						success: function (deneWordsArray) {
							$("#OrganismModal").modal('hide');
							alert("Request Submitted");
							$("#NewRememberedWordPanel").hide();
							refreshActive=true;
							RefreshInterface();

						},
						error: function(data){
							$("#NewRememberedWordPanel").hide();
							refreshActive=true;
							RefreshInterface();
							console.log("error getting denes :" + JSON.stringify(data));
							alert("Error getting denes:" + JSON.stringify(data));
							return false;
						}
					});
				});

				//
				// END OF functions for the new rememberedword functionality
				//



                $(document).on('click', ".RemoveChart",function(e) {
    	            e.preventDefault();
    	            var chartTitle = $(this).data("charttitle");
    	            
    	            localStorageManager.removeItem(LOCAL_STORAGE_SEARCH_KEY,chartTitle);
    	            refreshCounterStatus=true;
    	            searchFunctions.refreshSearchPage();
    	        });
                
                
                $(document).on('click', ".PulseTime",function(e) {
                    e.preventDefault();
                    var teleonomeName = $(this).data("teleonomename");
                    var pulseMillis = $(this).data("time");
                    searchFunctions.displayPulse(teleonomeName, pulseMillis);
                });
            
                
                $(document).on('click', ".MnemosyconRulesDetails",function(e) {
                    e.preventDefault();
                    var mnemosyconName = $(this).data("mnemosyconname");
                    var pulseMillis = $(this).data("time");
                    searchFunctions.displayMnemosyconRulesDetails(mnemosyconName, pulseMillis);
                });
            
            $(document).on('click', "#RefreshCounter",function(e) {
                    refreshCounterStatus=!refreshCounterStatus;
                    if(!refreshCounterStatus){
                    	 $("#RefreshCounter").html("||");
         	            $("#RefreshCounterMessage").html("Click to Start");
                    }else{
                        $("#RefreshCounter").html(refreshCounter);
                        $("#RefreshCounterMessage").html("Click to Pause");   
                    }       
                });    
            //
            // the search panel
            //
            
           // search_RefreshInterval =  setInterval(searchFunctions.refreshSearchPage, 30000); //NOTE: period is passed in milliseconds
        //	search_RefreshCounterInterval = setInterval(searchFunctions.refreshCounterUpdate, 1 * 1000);
            
            searchFunctions.loadNewVisualizerData();
	    
	        searchFunctions.generateAllGraphs();
	        var untilDate = new Date();
	        var fromDate = new Date();
	        fromDate.setDate(fromDate.getDate()-1);
	        var currentTimeAsString = untilDate.getHours() + ":" + untilDate.getMinutes() + ":"  + untilDate.getSeconds();
	    
	        $("#fromDate").valueAsDate = fromDate;
	        $("#fromTime").defaultValue = currentTimeAsString;
	    
	        $("#untilDate").valueAsDate = untilDate;
	        $("#untilTime").defaultValue = currentTimeAsString;
	        $('#WaitingWheel').hide();
    
	        
	    
	       
	    
	        $(document).on('click', ".PulseTime",function(e) {
	            e.preventDefault();
	            var teleonomeName = $(this).data("teleonomename");
	            var pulseMillis = $(this).data("time");
	            searchFunctions.displayPulse(teleonomeName, pulseMillis);
	        });
    
    
    		$(document).on('click', "#RefreshCounter",function(e) {
            	refreshCounterStatus=!refreshCounterStatus;
            	if(refreshCounterStatus){
            		refreshCounterStatus=false;
            	}else{
            		refreshCounterStatus=true;
            	}
            	
        	});    
    
    		$(document).on('click', "#GetDataSubmit",function(e) {
		        e.preventDefault();
		
		        
		        
		       
		        var visualizationStyle = $('#VisualisationType').find(":selected").val();
		        var identityPointer = document.getElementById("Identity").value;
		        var showMax = $("#StatsMax").is(':checked');
		        var showMin = $("#StatsMin").is(':checked');
		        var showAvg = $("#StatsAvg").is(':checked');
		        
		        var fromDate = document.getElementById("fromDate").value;
		        var fromTime = document.getElementById("fromTime").value;
		        var fromMillis = (new Date(fromDate + " " + fromTime)).getTime();
		        var untilDate = document.getElementById("untilDate").value;
		        var untilTime = document.getElementById("untilTime").value;
				var untilMillis = (new Date(untilDate + " " + untilTime)).getTime();
				var liveUpdateMinutes= +document.getElementById("LiveUpdateMinutes").value;
		        var formName="RememberDeneWord";
				var appendChart = $("#AppendChart").is(':checked');
				liveUpdate = $("#LiveUpdate").is(':checked');
				if(liveUpdate && liveUpdateMinutes<2){
					alert("Please input  live update minutes greater than 2");
					return false;
				}
		        if(fromDate=="" || fromTime==""){
					var date = new Date();
					//var fromDate = (date.getDate()-1) + "/" + (date.getMonth()+1) + "/" + date.getFullYear();
				//	var fromTime = date.getHours() + ":" + date.getMinutes();
					
		          //  var ts = Math.round(date.getTime() / 1000);
					//fromMillis = ts - (24 * 3600);
					fromMillis = date.getTime() - (liveUpdateMinutes * 60000);
					
		            //fromDate.setDate(fromDate.getDate()-1);
		            //fromMillis = fromDate.getTime();
		        }
		        if(untilDate=="" || untilTime==""){
					
					var date = new Date();
					untilMillis = date.getTime();
					var untilDate = date.getDate() + "/" + date.getMonth() + "/" + date.getFullYear();
					var untilTime = date.getHours() + ":" + date.getMinutes();
					
		        }else{
					//
					// if untildate is not blank, then is not a live update
					liveUpdate=false;
				}
		
		       
		        if(identityPointer=="" || identityPointer == undefined){
		            // var selectedTeleonome = $('#Teleonome').find(":selected").val();
		            // var selectedNucleus = $('#Nucleus').find(":selected").val();
		            // var selecteDeneChain = $('#DeneChain').find(":selected").val();
		            // var selecteDene = $('#Dene').find(":selected").val();
		            // var selecteDeneWord = $('#DeneWord').find(":selected").val();
		            // identityPointer = selectedTeleonome + ":" + selectedNucleus + ":" + selecteDeneChain + ":" + selecteDene + ":" + selecteDeneWord;
					// formName="LookUpDeneWord";
					
					alert("Please select a remembered deneword");
					return false;
		        }
		            
		        
		        
		        var localStoreageKey = identityPointer + "_" + visualizationStyle+"_" + liveUpdate  + "_" + fromMillis + "_" + untilMillis;
		        
		        if(localStorageManager.getItem(localStoreageKey) != undefined){
		            alert("Visualizer exists");
		            return false; 
		        }
		        var searchObject = JSON.parse(localStorageManager.getItem(LOCAL_STORAGE_SEARCH_KEY));
		        if(searchObject == null || searchObject==undefined){
		            searchObject={};
		        }
		        
		       var numberOfObjects =  localStorageManager.getNumberOfObjectsByComponent(LOCAL_STORAGE_SEARCH_KEY)+1;
		
		        var identity = identityFactory.createIdentityByPointer(identityPointer);
		        
		        var anyTeleonomeName = identity.teleonomeName;
				var chartTitle = anyTeleonomeName + "-" + identity.deneWordName;
				if(!liveUpdate)chartTitle = anyTeleonomeName + "-" + identity.deneWordName + " " + fromDate + " " + fromTime + "  -  " + untilDate + " " + untilTime;
				var chartDivId = anyTeleonomeName +  identity.deneWordName  + fromDate  + fromTime + untilDate  + untilTime;
				 chartDivId = chartDivId.replace(/\s/g, '');
				 chartDivId = chartDivId.replace(/-/g, '')
				 chartDivId = chartDivId.replace(/:/g, "");
				 chartDivId = chartDivId.replace(/\//g, "");
		        var jsonData = {
		            visualizationStyle:visualizationStyle,
		            identityPointer:identityPointer,
		            formName:formName,
		            appendChart:appendChart,
					liveUpdate:liveUpdate,
					liveUpdateMinutes:liveUpdateMinutes,
					chartTitle:chartTitle,
					chartDivId:chartDivId,
					showMax:showMax,
					showMin:showMin,
					showAvg:showAvg,
					
		            fromMillis:fromMillis,
		            untilMillis:untilMillis,
					position:numberOfObjects,
					localStoreageKey:localStoreageKey
		        }
		        var s = JSON.stringify(jsonData);
		        searchObject[localStoreageKey]=s;
		        
		        localStorageManager.setItem(LOCAL_STORAGE_SEARCH_KEY, searchObject);
				//searchFunctions.processForm(formName,identityPointer, fromMillis , untilMillis, appendChart, visualizationStyle, liveUpdate);
				refreshCounterStatus=true;
				searchFunctions.refreshSearchPage();
		        $('#WaitingWheel').hide();
				$("#SearchConfigurator").hide();
				refreshActive=true;
		        $("#TopButtons").show();
		        $("#UpdateArea").show();
		        
		        $("#RefreshCounter").show();
 	            $("#RefreshCounterMessage").show();
		    });
            //
            // the end of searchpanel
            //
			$(document).on('click', '#RebootButton',function(e){
				e.preventDefault();
				var confirm = confirmNetworkingMessage( 'Are you sure you want to reboot the Teleonome?') ;
				if(!confirm)return false;

				var commandCode = prompt("Please enter the code", "");
				if(isNaN(commandCode) || commandCode.length!=6){
					alert("The code must be 6 numbers");
					return false;
				}
				var currentIdentityModePointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_TYPE_VITAL + ":" +DENEWORD_TYPE_CURRENT_IDENTITY_MODE;
				var currentIdentityMode = getDeneWordByIdentityPointer(currentIdentityModePointer, DENEWORD_VALUE_ATTRIBUTE);
				
				var formName = $('#formName').val();
				var action = "Reboot";
				if(hasWlan0 && hasWlan1){
					
				}else{
					
				}
				if(currentIdentityMode == TELEONOME_IDENTITY_SELF){
					
					var enableNetworkMode = "No";
					if($('#EnableNetworkMode').bootstrapSwitch('state')){
						enableNetworkMode = "Yes";
					}

					var AvailableNetworks = $('#AvailableNetworks').val();
					var password = $('#password').val();
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:formName, EnableNetworkMode: enableNetworkMode,AvailableNetworks:AvailableNetworks, action:action, password:password, CommandCode:commandCode},
						success: function (commandId) {
							console.log("commandId=" + commandId);
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
				}else {	
					var enableHostMode = "No";
					if($('#EnableHostMode').bootstrapSwitch('state')){
						enableHostMode = "Yes";
					}
					$.ajax({
					type: "POST",
					url: "/TeleonomeServlet",
					data: {formName:formName, EnableHostMode: enableHostMode, action:action, CommandCode:commandCode},
					success: function (data) {
						
						var commandsInfo = JSON.parse(data);
						//
						// the response contains the id, and the status, which 
						// at this point should be COMMAND_REQUEST_PENDING_EXECUTION
						// put it on the table
						$('#SettingsWorkArea').empty();
						var panelHTML = renderCommandRequestTable(commandsInfo);
						$('#SettingsWorkArea').append(panelHTML);
					},
					error: function(data){
						console.log("error rebooting:" + data);
						alert("Error rebooting:" +  data);
						return false;
					}
				});	
				}	
			});
				$(document).on('change', '#AvailableNetworks',function(){
					var selectedValue = $("#AvailableNetworks :selected").text();
					
					if(selectedValue!=null && selectedValue.indexOf("Password")>-1){
						$('#ssidPassword').show();
					}else{
						$('#ssidPassword').hide();
					}
					
				});
				//
				// whitelist functions
				//
				
				
				$(document).on('click', '.removeFromWhiteListBtn',function(e){
					 // e.preventDefault();
					  var source = event.target || event.srcElement;
					  
					  var passwd = prompt("Please enter the password", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					  $(source).prop('disabled', true);
					  $(source).text('Pending');
					  var data = $.parseJSON($(this).attr('data-form'));
					  var deviceName = data.DeviceName;
					  //var deviceMacAddress = data.MacAddress;
					  //("#"+field + "Label").css('color', 'red');

					 var selected=""; 
					try{
					 var selectedField = $('#' + field);
					   selected = $('#' + field).val();
					   $(selected).prop('disabled', true);
					}catch(err){
					    console.log("error=" + err);
					}
					
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"RemoveFromWhiteList", DeviceName:deviceName, CommandCode : passwd },
						success: function (result) {
							console.log("removeFrom whitelist result=" +result);
							refreshActive=true;
							
						},
						error: function(data){
							console.log("error removing from  whitelist:" + JSON.stringify(data));
							alert("error removing to whitelist:" + JSON.stringify(data));
							refreshActive=true;
							return false;
						}
					});	
				});
				
				
				
				$(document).on('click', '.addAll',function(e){
					 // e.preventDefault();
					  var source = event.target || event.srcElement;
					  
					  var passwd = prompt("Please enter the password", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					  $(source).prop('disabled', true);
					  $(source).text('Pending');
					  var data = $.parseJSON($(this).attr('data-form'));
					  var deviceName = data.DeviceName;
					  var deviceMacAddress = data.MacAddress;
					  //("#"+field + "Label").css('color', 'red');

					 var selected=""; 
					try{
					 var selectedField = $('#' + field);
					   selected = $('#' + field).val();
					   $(selected).prop('disabled', true);
					}catch(err){
					    console.log("error=" + err);
					}
					
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"AddAllToWhiteList", CommandCode : passwd },
						success: function (result) {
							console.log("Add To White List result=" +result);
						},
						error: function(data){
							console.log("error adding to whitelist:" + JSON.stringify(data));
							alert("Error adding to whitelist:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on('click', '.addTWhiteListBtn',function(e){
					 // e.preventDefault();
					  var source = event.target || event.srcElement;
					  
					  var passwd = prompt("Please enter the password", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					  $(source).prop('disabled', true);
					  $(source).text('Pending');
					  var data = $.parseJSON($(this).attr('data-form'));
					  var deviceName = data.DeviceName;
					  var deviceMacAddress = data.MacAddress;
					  //("#"+field + "Label").css('color', 'red');

					 var selected=""; 
					try{
					 var selectedField = $('#' + field);
					   selected = $('#' + field).val();
					   $(selected).prop('disabled', true);
					}catch(err){
					    console.log("error=" + err);
					}
					
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"AddToWhiteList", DeviceName:deviceName, DeviceMacAddress:deviceMacAddress, CommandCode : passwd },
						success: function (result) {
							console.log("Add To White List result=" +result);
						},
						error: function(data){
							console.log("error adding to whitelist:" + JSON.stringify(data));
							alert("Error adding to whitelist:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				
				//
				// the functions related to the Settings Page
				//
				$(document).on('click', '#Wifi',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new Networking(panelPointer);
					var html = n.process(panelPointer);
					
					$('#SettingsWorkArea').html(html);
					$(".BSswitch").bootstrapSwitch();
					$('#SettingsWorkArea').show();
				});
				$(document).on('click', '#UpdateParams',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new UpdateParams();
					var html = n.process();
					$('#SettingsWorkArea').html(html);
					$('#SettingsWorkArea').show();
				});
				$(document).on('click', '#DeviceInfo',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new DeviceInfo();
					var html = n.process();
					$('#SettingsWorkArea').html(html);
					$('#SettingsWorkArea').show();
				});
				
				$(document).on('click', '.SettingsSubMenu',function(e){
					e.preventDefault();
					$('.UpdateParamsGroup').addClass('hidden');
					 
					  var source = event.target || event.srcElement;
					   var panelPointer  = $(this).data("panelpointer");	  
					  $("#"+panelPointer ).removeClass('hidden');
					  refreshActive=false;

				});


				$(document).on('click', '.UpdateParamBtn',function(e){
					 // e.preventDefault();
					  var source = event.target || event.srcElement;
					  
					  var passwd = prompt("Please enter the password", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					  $(source).prop('disabled', true);
					  $(source).text('Pending');
					  var data = $.parseJSON($(this).attr('data-form'));
					  var field = data.field;
					 $("#"+field + "Label").css('color', 'red');

					 var selected=""; 
					try{
					 var selectedField = $('#' + field);
					   selected = $('#' + field).val();
					   $(selected).prop('disabled', true);
					}catch(err){
					    console.log("error=" + err);
					}
					var restartRequired = data.restartRequired;
					if(restartRequired){
						$("#MainPowerButton").addClass('btn-danger').removeClass('btn-success');
						powerButtonRed=true;
					}
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"UpdateFormRequest", RestartRequired:restartRequired, ValueType:data.valueType, Identity: data.identity, Value: selected, CommandCode : passwd },
						success: function (commandIddata) {
							console.log("commandIddata=" +commandIddata);
							refreshActive=true;
							
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							refreshActive=true;
							return false;
						}
					});	
				});

				$(document).on('click', '#wlan0',function(e){
					e.preventDefault();
					//
					// if we are here it means that there is a wlan0 
					// now check if there is a wlan
					$("#NetworkingInfoArea").empty();
					var panelHtml = renderConfigurableWlan(DENE_WLAN0);
					$(".BSswitch").bootstrapSwitch();
					$("#NetworkingInfoArea").append(panelHtml);
				});
				$(document).on('click', '#wlan1',function(e){
					e.preventDefault();
					if(hasWlan0){
						//
						// in this case just display the info
						//
						$("#NetworkingInfoArea").empty();
						var panelHtml = renderWlan1Info();
						$("#NetworkingInfoArea").append(panelHtml);
					}else{
						//
						// if we are here it means that there is no wlan0 
						// and therefrewlan1 has to be able to switch
						// between host and organism
						$("#NetworkingInfoArea").empty();
						var panelHtml = renderConfigurableWlan(DENE_WLAN1);
						$(".BSswitch").bootstrapSwitch();
						$("#NetworkingInfoArea").append(panelHtml);
					}
					
				});

				$(document).on('click', '#UpdateHostShutdownButton,#UpdateHostRestartButton',function(e){
					e.preventDefault();
					var commandCode = prompt("Please enter the code", "");
					  if(isNaN(commandCode)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(commandCode.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					
					  var action="";
					  if(this.id='UpdateHostRestartButton'){
						  action="Reboot";
					  }else{
						  action:"Shutdown";
					  }
					var enableNetworkMode="No";
					var enableHostMode="Yes";
						
					  $("#MainPowerButton").attr("disabled", true);
					  $("#MainPowerButton").addClass('btn-warning').removeClass('btn-success');
					  $('#WaitingText').html("Please Wait3");
					  $('#WaitingWheel').show();
					  powerButtonDisabled=true;
					  $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"ReSignal", action:action, CommandCode : commandCode,  EnableNetworkMode:enableNetworkMode, EnableHostMode:enableHostMode},
						success: function (commandIddata) {
							 $('#WaitingWheel').hide();
							console.log("commandId=" + commandIddata);
							alert("Reboot as Host Request Sent");
							
							

						},
						error: function(data){
							 $('#WaitingWheel').hide();
							console.log("error restarting:" + JSON.stringify(data));
							alert("error restarting:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on('click', '#UpdateNetworkShutdownButton,#UpdateNetworkRestartButton',function(e){
					e.preventDefault();

					//
					 // now check that you have a value for SSID 
					 // and if needed a password
					 if($("#AvailableNetworks :selected")==null || ("#AvailableNetworks :selected")==""){
						 alert("Please select a SSID");
							return false;
					 }
					 var selectedSSID = $("#AvailableNetworks :selected").val();
					 var password="";
					 if(selectedSSID!=""){
						 var selectedValue = $("#AvailableNetworks :selected").text();
						 var passwordValid =  $("#password").val().length>7;
						 
							if(selectedValue!=null && selectedValue.indexOf("Password")>-1 ){
								if(passwordValid){
									password=$("#password").val();
								}
								else{
									alert("Please input SSID password");
									return false;
								}
								
							}
							
					 }else{
						 alert("Select an SSID");
						 return false;
					 }
					 
					 
					
					var commandCode = prompt("Please enter the code", "");
					  if(isNaN(commandCode)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(commandCode.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					
					  var action="";
					  if(this.id='UpdateNetworkRestartButton'){
						  action="Reboot";
					  }else{
						  action:"Shutdown";
					  }
					var enableNetworkMode="Yes";
					var enableHostMode="No";
					if( hasWlan1){
						 //
						 //if we are here the only
						  enableNetworkMode="Yes";
					}else{
							
						var currentIdentityModePointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_TYPE_VITAL + ":" +DENEWORD_TYPE_CURRENT_IDENTITY_MODE;
						var currentIdentityMode = getDeneWordByIdentityPointer(currentIdentityModePointer, DENEWORD_VALUE_ATTRIBUTE);
								
						if(currentIdentityMode == TELEONOME_IDENTITY_SELF){
							//if($('#EnableNetworkMode').bootstrapSwitch('state')){
								enableNetworkMode = "Yes";
							//}
						}else{
							//if($('#EnableHostMode').bootstrapSwitch('state')){
								enableHostMode = "Yes";
							//}	
						}		
					}
					
					
						
					  $("#MainPowerButton").attr("disabled", true);
					  $("#MainPowerButton").addClass('btn-warning').removeClass('btn-success');
					  $('#WaitingText').html("Please Wait3");
					  $('#WaitingWheel').show();
					  powerButtonDisabled=true;
					  $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"ReSignal", action:action, CommandCode : commandCode, AvailableNetworks:selectedSSID,password:password, EnableNetworkMode:enableNetworkMode, EnableHostMode:enableHostMode},
						success: function (commandIddata) {
							 $('#WaitingWheel').hide();
							console.log("commandId=" + commandIddata);
							alert("Reboot Request Sent");
							 

						},
						error: function(data){
							 $('#WaitingWheel').hide();
							console.log("error restarting:" + JSON.stringify(data));
							alert("error restarting:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on('click', '#RestartButton',function(e){
					e.preventDefault();

					// $('#CodeInputModalDescription').text('Are you sure you want to restart the Teleonome?<br> if so, please input the code');
					// $('#CodeInputModalTitle').text('Restart');
					// $('#ModalButonText').text('show');
					// $('#CodeInputModal').modal('show'); 


					var passwd = prompt("Are you sure you want to reboot?Please enter the code", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					
					  $("#MainPowerButton").attr("disabled", true);
					  $("#MainPowerButton").addClass('btn-warning').removeClass('btn-success');
					  $('#WaitingText').html("Please Wait4");
					  $('#WaitingWheel').show();
					  powerButtonDisabled=true;
					  $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"ReSignal", action:"Reboot", CommandCode : passwd },
						success: function (commandIddata) {
							console.log("commandId=" + commandIddata);
							//alert("Reboot Request Sent");
							

						},
						error: function(data){
							console.log("error restarting:" + JSON.stringify(data));
							alert("error restarting:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on('click', '#ShutdownButton',function(e){
					e.preventDefault();

					// $('#CodeInputModalDescription').text('Are you sure you want to restart the Teleonome?<br> if so, please input the code');
					// $('#CodeInputModalTitle').text('Restart');
					// $('#ModalButonText').text('show');
					// $('#CodeInputModal').modal('show'); 


					var passwd = prompt("Are you sure you want to shutdown?  Please enter the code", "");
					  if(isNaN(passwd)){
						alert("Code must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Code must be 6 numbers");
						  return false;
					  }
					
					  $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"ReSignal", action:"Shutdown", CommandCode : passwd },
						success: function (commandIddata) {
							console.log("commandId=" + commandIddata);
							alert("Shutdown Request Sent");
							$("#MainPowerButton").attr("disabled", true);
							$("#MainPowerButton").addClass('btn-warning').removeClass('btn-success');
							
						},
						error: function(data){
							console.log("error restarting:" + JSON.stringify(data));
							alert("error restarting:" + JSON.stringify(data));
							return false;
						}
					});	
				});
			

		

				//
				// end of settings page functions
				//

				//
				// the functions related to the diagnostics Page
				//
				
				
				$(document).on('click', '#AsyncUpdateButton',function(e){
					e.preventDefault();

					localStorageManager.removeComponentInfo(LOCAL_STORAGE_CURRENT_VIEW_KEY);
					var offset = 0;
					var limit = $( "#limit" ).val();
					var userLogs = $("#UserLogs").is(':checked')? "Yes":"No";
					var systemLogs = $("#SystemLogs").is(':checked')? "Yes":"No";

                	var currentViewObject ={};
					var jsonData = {
						offset:offset,
						limit:limit,
						userLogs:userLogs,
						systemLogs:systemLogs
					}
					var s = JSON.stringify(jsonData);
					currentViewObject["Data"]=s;
					currentViewObject["SecundaryView"]="AsynchronousDiagnostics";  
					localStorageManager.setItem(LOCAL_STORAGE_CURRENT_VIEW_KEY, currentViewObject);
				

					viewManager.AsynchronousDiagnostics();
				});

				$(document).on('click', '#Synchronous',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new SynchronousDiagnostics(panelPointer);
					var html = n.process(panelPointer);
					
					$('#DiagnosticsWorkArea').html(html);
					$(".BSswitch").bootstrapSwitch();
					$('#DiagnosticsWorkArea').show();
				});
				$(document).on('click', '#Asynchronous',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new AsynchronousDiagnostics();
					var html = n.process(panelPointer);
					$('#DiagnosticsWorkArea').html(html);
					$('#DiagnosticsWorkArea').show();
				});
				$(document).on('click', '#SystemDiagnostics',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new SystemDiagnostics();
					n.process(panelPointer);
					
					systemDiagnosticsPanelPointer = "@" +teleonomeName + ":" + NUCLEI_HUMAN_INTERFACE + ":" +panelPointer;
					renderPageByPointer(systemDiagnosticsPanelPointer, "DiagnosticsWorkArea");
					
					$('#DiagnosticsWorkArea').show();
					
					
					
					var mainBatteryOutputCurrentPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_SENSOR_DATA + ":" + DENE_POWER_STATUS + ":" +DENEWORD_MAIN_BATTERY_OUTPUT_CURRENT;
					if(containsDeneWordByIdentityPointer(mainBatteryOutputCurrentPointer)){
						var mainBatteryOutputCurrent = getDeneWordByIdentityPointer(mainBatteryOutputCurrentPointer, DENEWORD_VALUE_ATTRIBUTE);
					}
					
				    
					
					
					
					
					
					
					
				});
				
				$(document).on('click', '#Analysis',function(e){
					
					 $.ajax({
							type: "GET",
							url: "/TeleonomeServlet",
							data: {formName:"GenerateDenomeAnalysis" },
							success: function (data) {
								if(data=="Ok"){
									/* var n = new DenomeAnalysis();
									var html = n.process();
									$('#DiagnosticsWorkArea').html(html);
									$('#DiagnosticsWorkArea').show();
									$("#DenomeAnalysisFrame").attr("src", "TeleonomeAnalysis.html"); */
									var win = window.open('TeleonomeAnalysis.html', '_blank');
									if (win) {
									    //Browser has allowed it to be opened
									    win.focus();
									} else {
									    //Browser has blocked it
									    alert('Please allow popups for this website');
									}
								}else{
									console.log("error generating analysis:" + JSON.stringify(data));
									alert("Error generating Analysis");
									return false;
								}
								
							},
							error: function(data){
								console.log("error generating analysis:" + JSON.stringify(data));
								alert("Error generating Analysis");
								return false;
							}
						});	
					 
					
				});
				
				$(document).on('click', '#Mnemosycons',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new Mnemosycons();
					var html = n.process();
					$('#DiagnosticsWorkArea').html(html);
					$('#DiagnosticsWorkArea').show();
				});
				//
				// end of diagnostics page functions
				//
		        	$('#WaitingWheel').hide();
			});
			
			
			function confirmNetworkingMessage( mensaje) {
				 //
				 // check we are enabling network mode
				 var enabledNetworkMode = $("#EnableNetworkMode").is(':checked');
				 if(enabledNetworkMode){
					 //
					 // now check that you have a value for SSID 
					 // and if needed a password
					 if($("#AvailableNetworks :selected")==null || ("#AvailableNetworks :selected")==""){
						 alert("Please select a SSID");
							return false;
					 }
					 var selectedSSID = $("#AvailableNetworks :selected").val();
					 if(selectedSSID!=""){
						 var selectedValue = $("#AvailableNetworks :selected").text();
						 var password =  $("#password").val().length>7;
						 
							if(selectedValue!=null && 
							  selectedValue.indexOf("Password")>-1 &&
							  !password
							){
								alert("Please input SSID password");
								return false;
							}
					 }else{
						 alert("Select an SSID");
						 return false;
					 }
					 
				 }
				 var answer = confirm(mensaje);
				 return answer;
				 
			}
			
			
		
			
		function renderWlan1Info(){
			 var currentIdentityModePointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_TYPE_VITAL + ":" +DENEWORD_TYPE_CURRENT_IDENTITY_MODE;
             var currentIdentityMode = getDeneWordByIdentityPointer(currentIdentityModePointer, DENEWORD_VALUE_ATTRIBUTE);
            
             var ipAddressPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_WLAN0 + ":" +DENEWORD_IP_ADDRESS;
             var ipAddress = getDeneWordByIdentityPointer(ipAddressPointer, DENEWORD_VALUE_ATTRIBUTE);
             
             var accessPointPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_WLAN0 + ":" +DENEWORD_ACCESS_POINT;
             var accessPoint = getDeneWordByIdentityPointer(accessPointPointer, DENEWORD_VALUE_ATTRIBUTE);
            
             
             var essidPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_WIFI_INFO + ":" +"ESSID";
             var essid = getDeneWordByIdentityPointer(essidPointer, DENEWORD_VALUE_ATTRIBUTE);
             if(essid == undefined)essid="";
             
             
             var linkQualityPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_WIFI_INFO + ":" +LINK_QUALITY;
             var linkQuality = getDeneWordByIdentityPointer(linkQualityPointer, DENEWORD_VALUE_ATTRIBUTE);
             var signallevelPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_WIFI_INFO + ":" +SIGNAL_LEVEL;
             var signallevel = getDeneWordByIdentityPointer(signallevelPointer, DENEWORD_VALUE_ATTRIBUTE);
             
              var panelHTML = "<div class=\"row\">";
              panelHTML += "<label id=\"CurrentESSID\">Access Point:&nbsp;&nbsp;"+ accessPoint +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
              panelHTML += "<label id=\"CurrentIPAddress\">Current IPAddress:&nbsp;&nbsp;"+ ipAddress +"</label><br>";
              panelHTML += "<label id=\"LinkQuality\">Link Quality:&nbsp;&nbsp;"+ linkQuality +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
              panelHTML += "<label id=\"SignalLevel\">Signal Level:&nbsp;&nbsp;"+ signallevel +"</label>";
              panelHTML += "</div>";
              
              return panelHTML;
		}
		//
		// because the pi always has a built in wifi, at a minimum wlan1 will always exist
		// if there is no wlan0 then wlan1 has to be able to switch between host and organism
		
		// if there is a wlan0 then it means that the wlan1 would be using the host ip
		// and wlan0 could or not have an ip given by some dhcp server in the network
		// 
		
		function renderConfigurableWlan(selectedWlanDene){
	                

	                var currentIdentityModePointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_TYPE_VITAL + ":" +DENEWORD_TYPE_CURRENT_IDENTITY_MODE;
	                var currentIdentityMode = getDeneWordByIdentityPointer(currentIdentityModePointer, DENEWORD_VALUE_ATTRIBUTE);
	               
	                var ipAddressPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + selectedWlanDene + ":" +DENEWORD_IP_ADDRESS;
	                var ipAddress = getDeneWordByIdentityPointer(ipAddressPointer, DENEWORD_VALUE_ATTRIBUTE);
	                
	                var accessPointPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + selectedWlanDene + ":" +DENEWORD_ACCESS_POINT;
	                var accessPoint = getDeneWordByIdentityPointer(accessPointPointer, DENEWORD_VALUE_ATTRIBUTE);
	               
	                
	                var essidPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + selectedWlanDene + ":" +"ESSID";
	                var essid = getDeneWordByIdentityPointer(essidPointer, DENEWORD_VALUE_ATTRIBUTE);
	                if(essid == undefined)essid="";
	                
	                
	                var linkQualityPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + selectedWlanDene + ":" +LINK_QUALITY;
	                var linkQuality = getDeneWordByIdentityPointer(linkQualityPointer, DENEWORD_VALUE_ATTRIBUTE);
	                var signallevelPointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + selectedWlanDene + ":" +SIGNAL_LEVEL;
	                var signallevel = getDeneWordByIdentityPointer(signallevelPointer, DENEWORD_VALUE_ATTRIBUTE);
	                
	                var panelHTML = "<Form id=\"Resignal\" name=\"ReSignal\"  id=\"MainForm\" method=\"POST\" action=\"TeleonomeServlet\">";
	                
	                if( hasWlan0 && hasWlan1){
	                    //
	                    // there are two wifi interfaces, and wlan0 is the external wifi allow the user to change SSID
	                    // wlan0 will not be associated to an existing network when the teleonome is first created
	                    // first check that it is actually associated
	                     
		                if(accessPoint!=NOT_ASSOCIATED){
		                	 panelHTML += "<div class=\"row\">";
			                    panelHTML += "<label id=\"CurrentESSID\">Access Point:&nbsp;&nbsp;"+ accessPoint +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
			                    panelHTML += "<label id=\"CurrentIPAddress\">Current IPAddress:&nbsp;&nbsp;"+ ipAddress +"</label><br>";
			                    panelHTML += "<label id=\"LinkQuality\">Link Quality:&nbsp;&nbsp;"+ linkQuality +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
			                    panelHTML += "<label id=\"SignalLevel\">Signal Level:&nbsp;&nbsp;"+ signallevel +"</label>";
			                    panelHTML += "</div>";
		                }
	                   
	                   
	                    panelHTML += "<div class=\"row\">";
	                    panelHTML += "<div class=\"col-xs-12\" style=\"height: 20px;\"></div>";
	                    panelHTML += "</div>";
	                    panelHTML += "</center>";
	                    panelHTML += "<div id=\"NetworkMode\">";
	                    panelHTML += "<center>";
	                    panelHTML += "<div class=\"row\">";
	          
	                    panelHTML += "<h4><label class=\"RadioLabel\">Enable Network Mode</label><h4><br>";
	                   // panelHTML += "<input class=\"BSswitch\" id=\"EnableNetworkMode\" name=\"EnableNetworkMode\" type=\"checkbox\" data-on-text=\"Yes\" \"Enable Host Mode\"  data-off-text=\"No\" value=\"Yes\">"; 
	                   // panelHTML += "<input type=\"hidden\"  id=\"EnableNetworkMode\" name=\"EnableNetworkMode\" value=\"Yes\">"; 
	                    panelHTML += "</div>";
	                    panelHTML += "<div class=\"row\"><div class=\"col-xs-12\" style=\"height: 2px;\"></div></div>";
	                    panelHTML += "<div class=\"row\">";
	                    panelHTML += "<div id=\"AvailableNetworkSection\">";
	                    panelHTML += "<label>Available Networks:</label><br>";
	                    panelHTML += "<select id=\"AvailableNetworks\" name=\"AvailableNetworks\"></select>";
	                    panelHTML += "</select>";
	                    panelHTML += "</div>";
	                    panelHTML += "</div>";
	                    panelHTML += "<div class=\"row\"><div class=\"col-xs-12\" style=\"height: 30px;\"></div></div>";
	                    panelHTML += "<div class=\"row\">";
	                    panelHTML += "<div id=\"ssidPassword\">";
	                    panelHTML += "<label>Input Password:</label><br>";
	                    panelHTML += "<input type=\"password\" id=\"password\" name=\"password\"></select>";
	                    panelHTML += "</div>";
	                    panelHTML += "</div>";
	                    panelHTML += "<div class=\"row\">";
	                    panelHTML += "<div class=\"col-xs-12\" style=\"height: 30px;\"></div>";
	                    panelHTML += "</div>";
	                    panelHTML += "</center>";
	                    panelHTML += "</div>";
	        
	                    //
	                    // set up the available ssids
	                    //
	                    $('#WaitingText').html("Please Wait5...");
	                    $('#WaitingWheel').show();
	                
	                    $.ajax({
	                        type: "GET",
	                        url: "/TeleonomeServlet",
	                        data: {formName:"GetSSIDs" },
	                        success: function (availableSSIDs) {
	                            //console.log("availableSSIDs=" + data);
	                           // var availableSSIDs = JSON.parse(data);
	                            $('#AvailableNetworks').append('<option value="">Select SSID</option>');
	                            for(var i = 0; i < availableSSIDs.length; i++) {
	                                var item = availableSSIDs[i];
	                                var security="";
	                                if(item["Authentication"]!=null && item["Authentication"].indexOf("PSK")>-1)security="Password";
	                                var key = item["SSID"]+ "-" + item["Signal"] + " " + security;
	                                var value=item["SSID"] ;
	                                //ssidOptions += "<option value=\""+ value+"\">"+ key +"</option>";
	                                $('#AvailableNetworks').append($('<option>', {value:value, text:key}));
	                            }	
	                            $('#ssidPassword').hide();
	                            $('#WaitingWheel').hide();
	                        },
	                        error: function(data){
	                            $('#WaitingWheel').hide();
	                            console.log("error getting log file:" + JSON.stringify(data));
	                            alert("Error getting log:" + JSON.stringify(data));
	                            return false;
	                        }
	                    });
	                    
	                 
	                }else if (hasWlan1){
	                    
	                    //
	                    // there is only one wifi, so allow the user to change to host or organism
	                    //
	                   
	                    if(currentIdentityMode == TELEONOME_IDENTITY_SELF){
	                        panelHTML += "<div id=\"NetworkMode\">";
	                        panelHTML += "<center>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<h4><label class=\"RadioLabel\">Enable Network Mode</label></h4><br>";
	                        //panelHTML += "<input class=\"BSswitch\" id=\"EnableNetworkMode\" name=\"EnableNetworkMode\" type=\"checkbox\" data-on-text=\"Yes\" \"Enable Host Mode\"  data-off-text=\"No\" value=\"Yes\">"; 
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\"><div class=\"col-xs-12\" style=\"height: 20px;\"></div></div>";
	            
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<div id=\"AvailableNetworkSection\">";
	                        panelHTML += "<label>Available Networks:</label><br>";
	                        panelHTML += "<select id=\"AvailableNetworks\" name=\"AvailableNetworks\"></select>";
	                        
	                        
	            
	                       
	                        panelHTML += "</select>";
	                        panelHTML += "</div>";
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\"><div class=\"col-xs-12\" style=\"height: 30px;\"></div></div>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<div id=\"ssidPassword\">";
	                        
	                        panelHTML += "<label>Input Password:</label><br>";
	                        panelHTML += "<input type=\"password\" id=\"password\" name=\"password\"></select>";
	                        panelHTML += "</div>";
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<div class=\"col-xs-12\" style=\"height: 30px;\"></div>";
	                        panelHTML += "</div>";
	                        panelHTML += "</center>";
	                        panelHTML += "</div>";
	            
	                        //
	                        // set up the available ssids
	                        //
	                        $('#WaitingText').html("Please Wait1...");
	                        $('#WaitingWheel').show();
	                    
	                        $.ajax({
	                            type: "GET",
	                            url: "/TeleonomeServlet",
	                            data: {formName:"GetSSIDs" },
	                            success: function (availableSSIDs) {
	                                //console.log("availableSSIDs=" + data);
	                               // var availableSSIDs = JSON.parse(data);
	                                $('#AvailableNetworks').append('<option value="">Select SSID</option>');
	                                for(var i = 0; i < availableSSIDs.length; i++) {
	                                    var item = availableSSIDs[i];
	                                    var security="";
	                                    if(item["Authentication"]!=null && item["Authentication"].indexOf("PSK")>-1)security="Password";
	                                    var key = item["SSID"]+ "-" + item["Signal"] + " " + security;
	                                    var value=item["SSID"] ;
	                                    //ssidOptions += "<option value=\""+ value+"\">"+ key +"</option>";
	                                    $('#AvailableNetworks').append($('<option>', {value:value, text:key}));
	                                }	
	                                $('#ssidPassword').hide();
	                                $('#WaitingWheel').hide();
	                            },
	                            error: function(data){
	                                $('#WaitingWheel').hide();
	                                console.log("error getting log file:" + JSON.stringify(data));
	                                alert("Error getting log:" + JSON.stringify(data));
	                                return false;
	                            }
	                        });	
	            
	                    }else{
	                        panelHTML += "<div id=\"SelfMode\">";
	                        panelHTML += "<center>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<label id=\"CurrentESSID\">Current SSID:&nbsp;&nbsp;"+ essid +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
	                        panelHTML += "<label id=\"CurrentIPAddress\">Current IPAddress:&nbsp;&nbsp;"+ ipAddress +"</label><br>";
	                        panelHTML += "<label id=\"LinkQuality\">Link Quality:&nbsp;&nbsp;"+ linkQuality +"</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
	                        panelHTML += "<label id=\"SignalLevel\">Signal Level:&nbsp;&nbsp;"+ signallevel +"</label>";
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<div class=\"col-xs-12\" style=\"height: 20px;\"></div>";
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<h4><label class=\"RadioLabel\">Enable Host Mode</label></h4><br>";
	                        //panelHTML += "<input class=\"BSswitch\" id=\"EnableHostMode\" name=\"EnableHostMode\" type=\"checkbox\" data-on-text=\"Yes\" \"Enable Host Mode\"  data-off-text=\"No\" value=\"Yes\"> ";
	                        panelHTML += "</div>";
	                        panelHTML += "<div class=\"row\">";
	                        panelHTML += "<div class=\"col-xs-12\" style=\"height: 20px;\"></div>";
	                        panelHTML += "</div>";
	                        panelHTML += "</center>";
	                        panelHTML += "</div>";
	                    }
	                    
	                    
	                    if(currentIdentityMode == TELEONOME_IDENTITY_SELF){
	                        //
	                        // layout the connected clients
	                        //
	                        panelHTML += "<div class=\"row\">";
	                        var screensize = document.documentElement.clientWidth;
	                        if(screensize<500){
	                            panelHTML += "<div  class=\"col-xs-1\"></div>";
	                            panelHTML += "<div id=\"ConnectedClients\" class=\"col-lg-6  col-xs-10\"></div>";
	                            panelHTML += "<div  class=\"col-xs-1\"></div>";
	                        }else{
	                            panelHTML += "<div id=\"ConnectedClients\" class=\"col-lg-6  col-xs-12\"></div>";
	                        }
	                        
	                        panelHTML += "</div>";
	                        
	                        $.ajax({
	                            type: "GET",
	                            url: "/TeleonomeServlet",
	                            data: {formName:"GetConnectedClients" },
	                            success: function (connectedClients) {
	                                console.log("commandId=" + connectedClients);
	                                var clientsTable="";
	                                $('#ConnectedClients').empty();
	                                if(connectedClients.length>0){
	                                    
	                                    clientsTable += "<br><label><h4>Connected Clients:</h4></label><br>";
	                                    clientsTable += "	<table id=\"ClientsTable\" class=\"table table-striped table-responsive\">";
	                                    clientsTable += "<thead>";
	                                    clientsTable += "<tr> <th class=\"text-center\">Name</th> <th class=\"text-center\">IPAddress</th></tr>";
	                                    clientsTable += "</thead>";
	                                    clientsTable += "<tbody>";
	            
	                                    for(var i = 0; i < connectedClients.length; i++) {
	                                        var obj = connectedClients[i];
	                                        clientsTable += "<tr><td>" + obj.name + "</td><td>"+obj.ipaddress+"</td></tr>";
	                                    }	
	                                    clientsTable += "</tbody>";
	                                    clientsTable += "</table>";
	                                    $('#ConnectedClients').append(clientsTable);
	                                }
	                                    
	                            },
	                            error: function(data){
	                                console.log("error getting log file:" + JSON.stringify(data));
	                                
	                                return false;
	                            }
	                        });	
	                    }
	                }
	        
	                 panelHTML += "<input type=\"Hidden\" id=\"formName\" name=\"formName\" value=\"ReSignal\">";
	                 // panelHTML += "<div class=\"row\"><div class=\"col-xs-12\" style=\"height: 100px;\"></div></div>";
	                 panelHTML += "<div class=\"row\">";
	                 panelHTML += "<div class=\"col-lg-3 co	l-xs-1\"></div>";
	                 if(currentIdentityMode == TELEONOME_IDENTITY_ORGANISM){
	                	 panelHTML += "<div class=\"col-lg-3 col-xs-4\"><input class=\"btn btn-primary  btn-lg\" type=\"Submit\" name=\"action\" id=\"UpdateHostRestartButton\" value=\"Reboot\"></div>";
		                 panelHTML += "<div class=\"col-lg-1  col-xs-1\"></div>";
		                 panelHTML += "<div class=\"col-lg-3 col-xs-5\"><input class=\"btn btn-primary  btn-lg\" type=\"Submit\"  name=\"action\" id=\"UpdateHostkShutdownButton\" value=\"Shutdown\"></div>";
		                 panelHTML += "<div class=\"col-lg-2  col-xs-1\"></div>"; 
	                 }else{
	                	 panelHTML += "<div class=\"col-lg-3 col-xs-4\"><input class=\"btn btn-primary  btn-lg\" type=\"Submit\" name=\"action\" id=\"UpdateNetworkRestartButton\" value=\"Reboot\"></div>";
		                 panelHTML += "<div class=\"col-lg-1  col-xs-1\"></div>";
		                 panelHTML += "<div class=\"col-lg-3 col-xs-5\"><input class=\"btn btn-primary  btn-lg\" type=\"Submit\"  name=\"action\" id=\"UpdateNetworkShutdownButton\" value=\"Shutdown\"></div>";
		                 panelHTML += "<div class=\"col-lg-2  col-xs-1\"></div>";
	                 }
	               
	                 panelHTML += "</div>";
	                 panelHTML += "</form>";	
	                return panelHTML;
	            }
		</script>

		<!-- Placed at the end of the document so the pages load faster -->
</body>
</html>
