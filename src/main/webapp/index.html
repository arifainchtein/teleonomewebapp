
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="favicon.ico">

<title>Teleonome</title>

<!-- Bootstrap core CSS -->
<link href="bootstrap.min.css" rel="stylesheet">
<link href="bs/css/bootstrap-switch.css" rel="stylesheet">
<link href="css/UpdateParams.css" rel="stylesheet">
<link href="css/SearchPanel.css" rel="stylesheet">



<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<style>
.top-buffer {
	margin-top: 20px;
}


.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2,
	.col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3,
	.col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5,
	.col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6,
	.col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8,
	.col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9,
	.col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11,
	.col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12
	{
	padding-left: 5px;
	padding-right: 5px;
}

.panel-heading.row {
  margin: 0;
  padding-left: 0;
  padding-right: 0;
}

@media(max-width:767px){
	h5, .h5 {
    	font-size: 16px;
	}
}

@media(min-width:768px){
	.panel-heading h6 {
		font-size: 1.5em;
	}
}
@media(min-width:992px){}
@media(min-width:1200px){}



/* Sticky footer styles
-------------------------------------------------- */
html, body {
	height: 100%;
	/* The html and body elements cannot have any padding or margin. */
}

/* Wrapper for page content to push down footer */
#wrap {
	min-height: 100%;
	height: auto !important;
	height: 100%;
	/* Negative indent footer by its height */
	margin: 0 auto -60px;
	/* Pad bottom by footer height */
	padding: 0 0 60px;
}

/* Set the fixed height of the footer here */
#footer {
	height: 60px;
	background-color: white;
}

/* Custom page CSS
-------------------------------------------------- */
/* Not required for template or sticky footer method. */
#wrap>.container {
	padding: 10px 15px 0;
}

#footer>.container {
	padding-left: 15px;
	padding-right: 15px;
}

.navbar-header {
	float: none;
	width: 100%;
	padding: 10px;
}

.navbar-brand {
	font-size: 20pt;
	float: none;
}

#bottomNav {
	padding: 10px;
	background-color: black;
}

#bottomNav a {
	font-size: 10pt;
	color: white;
	text-decoration: none;
}

#bottomNav a:hover {
	color: #fff;
}

/*
for chart
*/
path { 
	stroke: steelblue;
	stroke-width: 2;
	fill: none;
}

.axis path,
.axis line {
	fill: none;
	stroke: grey;
	stroke-width: 1;
	shape-rendering: crispEdges;
}



input:invalid {
  border: 1px solid red;
}

input:valid {
  border: 1px solid green;
}

@media (min-width: 768px) {
  .modal-xl {
    width: 90%;
   
  }
}


.glyphicon.glyphicon-signal,  .glyphicon.glyphicon-tasks, .glyphicon.glyphicon-info-sign{
    font-size: 20px;
    margin-top:-25px;
   
}
.SettingBar{
    text-align: center;
}

.SettingBar:hover {
    color:salmon;
}

.label{
	font-size:45%;
}
.LowerNavFunction{
	
}

.SettingsMenu{
	cursor: pointer;
}
</style>
</head>

<body>

	<div class="container">

		<!-- Static navbar -->
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="row">
					<div id="status" class="col-lg-4 col-md-4 col-sm-6 col-xs-5">
						<h3>
							<div style="padding-left: 5px;" id="teleonomeName">Connecting...</div>
						</h3>
					</div>

					<div id="Pathology" class="col-lg-3 col-md-3 col-sm-2 col-xs-2 label label-lg label-danger text-white top-buffer"  style="display: none;">
						<h5><span id="ErrorText" style="color:white;" ></span></h5>
					</div>
		
					<div  class="hidden-lg hidden-md hidden-sm col-xs-1"></div>

					<div  class="col-lg-2 col-md-2 col-sm-1 col-xs-2 col-xs-offset-2">
						<h3>
							<span id="TeleonomeDataStatus"
								class=" label label-sm label-danger collapse" style="display: none;" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
						</h3>
						<h6>Data</h6>
					</div>
					<div  class="col-lg-1 col-md-1 col-sm-1 hidden-xs"></div>
					<div  class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
						<h3>
							<span id="TeleonomeStatus" class="label label-sm label-default collapse" style="display: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
						</h3>
						<h6>Status</h6>
					</div>
				</div>
			</div>
			<!--/.container-fluid -->
		</nav>

		<div class="row collapse">
			<div id="CommandRequestStatus" class="alert alert-info">
			</div>	
		</div>
		<div id="PulseInfo" class="well well-sm">
			<h5>
				Pulse: <span id="PulseTimestamp"></span> <span class="hidden-xs" >&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</span>
				<strong><span id="TimeSinceLastPulse" class="pull-right"></span></strong>
				<span class="hidden-sm hidden-md hidden-lg" ><br></span>
				Last Pulse Creation: <span id="PulseCreationTime"></span>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
				<strong><span class="hidden-xs" >Operational Mode:</span><span id="WPSInfo"></span></strong>
				<br>
			</h5>
			<h6><span id="PulseStatusInfo" >Pulse Status Info</span><br><span id="PulseStatusInfoSecundary" ></span></h6>
		</div>

		
		
		
		<div class="row">
			<div  style="display: none;" class="col-lg-12 col-md-12 col-sm-12 col-sm-12 col-xs-12 text-center">
				<div id="ErrorMessage" class="alert alert-danger">
				</div>
			</div>
		</div>

		<div id="EntryPoint" class="container-fluid"></div>
		<div id="Graph" ><div id="footer">
			<div class="col-xs-12 navbar-default navbar-fixed-bottom">
				<div class="row" id="bottomNav">
				</div>
			</div>
		</div></div>
		
		

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script>
			window.jQuery
					|| document
							.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')
		</script>
		<script src="bootstrap.min.js"></script>
		 <!-- 
		 <script src="//d3js.org/d3.v4.min.js"></script>
		  -->
		 <script src="http://d3js.org/d3.v3.min.js"></script>
		  
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"
			type="text/javascript"></script>
 		
 		
		<script type="text/javascript" src="TeleonomeConstants.js"></script>
		<script src="bs/js/bootstrap-switch.js"></script>

		<script type="text/javascript" src="HashMap.js"></script>
		<script type="text/javascript" src="Identity.js"></script>
		<script type="text/javascript" src="D3Chart.js"></script>
		<script type="text/javascript" src="CSVMultiLineChart.js"></script>
		<!-- Make sure that LocalStorageManager.js is loaded before the SearchFunctions.js -->
		<script type="text/javascript" src="LocalStorageManager.js"></script>
		<!-- Make sure that SearchFunctions.js.js is loaded before the GeneralFunctions.js -->
		<script type="text/javascript" src="SearchFunctions.js"></script>
		
		<!-- Make sure that GeneralFunctions.js is loaded before the DenomeFunctions.js -->
		<script type="text/javascript" src="GeneralFunctions.js"></script>
		<!-- Make sure that DenomeFunctions.js is loaded before the templates -->
		<script type="text/javascript" src="DenomeFunctions.js"></script>
		<!-- The templates, make sure they are loaded after the two Functions files -->
		<script type="text/javascript" src="templates/SettingsInfo.js"></script>
		<script type="text/javascript" src="templates/DeneWordTable.js"></script>
		<script type="text/javascript" src="templates/DeviceInfo.js"></script>
		<script type="text/javascript" src="templates/Networking.js"></script>
		<script type="text/javascript" src="templates/UpdateParams.js"></script>
		<script type="text/javascript" src="templates/WellSingleValuePanel.js"></script>
		<script type="text/javascript" src="templates/DailyWeatherForecast.js"></script>
		<script type="text/javascript" src="templates/ShortTermWeatherForecast.js"></script>
		<script type="text/javascript" src="templates/MnemosyneTable.js"></script>
		<script type="text/javascript" src="templates/SingleValuePanelExternalData.js"></script>
		<script type="text/javascript" src="templates/SingleValuePanelExternalTimestamp.js"></script>
		<script type="text/javascript" src="templates/PathologyPanel.js"></script>
		<script type="text/javascript" src="templates/CompleteDeneSingleValuePanel.js"></script>
		<script type="text/javascript" src="templates/ActionEvaluationReport.js"></script>
		<script type="text/javascript" src="templates/OrganismView.js"></script>
		<script type="text/javascript" src="templates/SearchPanel.js"></script>
		<!-- The templates, make sure RenderingEngine is loaded after all the templates -->
		<script type="text/javascript" src="RenderingEngine.js"></script>
		<!-- The Heart Communication is tbe the last one to be loaded -->
		<script type="text/javascript" src="HeartComms.js"></script>

		<script>
		 var liveUpdate;
	     var search_RefreshInterval;
	     var search_RefreshCounterInterval;
	     var refreshCounter=30;
	     var refreshCounterStatus=true;
	     var localStorageSearchKey="Search";
	     var localStorageManager;
	     var searchFunctions;
	     
			$(document).ready(function() {
				localStorageManager = new LocalStorageManager();
				searchFunctions = new SearchFunctions();
				HeartConnect();
				
			

				//
				// before we actually connect ask the server for the visualizer
				//	
				$(document).on("click", '.pathology-log-link', function(e) {
					e.preventDefault();
					var ref = this.getAttribute('href');
					$('.pathology-modal-body').html("");
					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"GetLogFile", logFileName:ref},
						success: function (data) {
							console.log("data=" + data);
							$('.pathology-modal-body').html(data);
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
				});
				
				$(document).on("click", ".dismissbannerformmodal", function () {
					if(refreshInterfaceAfterModalNeeded){
						refreshInterfaceAfterModalNeeded=false;
						RefreshInterface();
					}
				});
				
				
                $(document).on("click", ".pathology-showLogsLink", function () {
                    var dirName = $(this).attr("data-dirname");
                    
                    
                    
                    $.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:"GetLogFileNames", dirName:dirName},
						success: function (data) {
							console.log("data=" + data);
							
							$(".pathology-file-list").empty(); 
							var array =  data.split(",");
							var arrayLength = array.length;
							for (var i = 0; i < arrayLength; i++) {
							    $(".pathology-file-list").append('<li><a href=\"logs/'+ dirName + '/'+array[i]+'.txt\" class=\"pathology-log-link\" id=\"'+array[i]+'\">'+ array[i] +'</a></li>');   
							}
							
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
                    
                   
                  
                });
				
                
            
                
                var untilDate = new Date();
                var fromDate = new Date();
                fromDate.setDate(fromDate.getDate()-1);
                var currentTimeAsString = untilDate.getHours() + ":" + untilDate.getMinutes() + ":"  + untilDate.getSeconds();
            
                $("#fromDate").valueAsDate = fromDate;
                $("#fromTime").defaultValue = currentTimeAsString;
            
                $("#untilDate").valueAsDate = untilDate;
                $("#untilTime").defaultValue = currentTimeAsString;
                $('#WaitingWheel').hide(); 
            
                $(document).on('click', "#NewChart",function(e) {
                    e.preventDefault();
                    $("#TopButtons").hide();
                    refreshCounterStatus=false;
                    $("#RefreshCounter").hide();
     	            $("#RefreshCounterMessage").hide();
                    searchFunctions.loadNewVisualizerData();
                    $("#SearchConfigurator").show();
                    
                });
             
                $(document).on('click', "#CancelSearch",function(e) {
                    e.preventDefault();
                    $("#SearchConfigurator").hide();
                    $("#TopButtons").show();
                    $("#RefreshCounter").show();
     	            $("#RefreshCounterMessage").show();
                    refreshCounterStatus=true;
                });
                
                
                $(document).on('click', "#ClearCharts",function(e) {
                    e.preventDefault();
                   
                    localStorageManager.removeComponentInfo(localStorageSearchKey);
                    $("#RefreshCounter").html("");
                    $("#SearchGraphArea").empty();
                    refreshCounterStatus=false;
                    searchFunctions.refreshSearchPage();
                });
            
                $(document).on('click', ".RemoveChart",function(e) {
    	            e.preventDefault();
    	            var chartTitle = $(this).data("charttitle");
    	            
    	            localStorageManager.removeItem(localStorageSearchKey,chartTitle);
    	            refreshCounterStatus=true;
    	            searchFunctions.refreshSearchPage();
    	        });
                
                
                $(document).on('click', ".PulseTime",function(e) {
                    e.preventDefault();
                    var teleonomeName = $(this).data("teleonomename");
                    var pulseMillis = $(this).data("time");
                    searchFunctions.displayPulse(teleonomeName, pulseMillis);
                });
            
            
            $(document).on('click', "#RefreshCounter",function(e) {
                    refreshCounterStatus=!refreshCounterStatus;
                    if(!refreshCounterStatus){
                    	 $("#RefreshCounter").html("||");
         	            $("#RefreshCounterMessage").html("Click to Start");
                    }else{
                        $("#RefreshCounter").html(refreshCounter);
                        $("#RefreshCounterMessage").html("Click to Pause");   
                    }       
                });    
            //
            // the search panel
            //
            
            search_RefreshInterval =  setInterval(searchFunctions.refreshSearchPage, 30000); //NOTE: period is passed in milliseconds
        	search_RefreshCounterInterval = setInterval(searchFunctions.refreshCounterUpdate, 1 * 1000);
            
            searchFunctions.loadNewVisualizerData();
	    
	        searchFunctions.generateAllGraphs();
	        var untilDate = new Date();
	        var fromDate = new Date();
	        fromDate.setDate(fromDate.getDate()-1);
	        var currentTimeAsString = untilDate.getHours() + ":" + untilDate.getMinutes() + ":"  + untilDate.getSeconds();
	    
	        $("#fromDate").valueAsDate = fromDate;
	        $("#fromTime").defaultValue = currentTimeAsString;
	    
	        $("#untilDate").valueAsDate = untilDate;
	        $("#untilTime").defaultValue = currentTimeAsString;
	        $('#WaitingWheel').hide();
    
	        
	    
	       
	    
	        $(document).on('click', ".PulseTime",function(e) {
	            e.preventDefault();
	            var teleonomeName = $(this).data("teleonomename");
	            var pulseMillis = $(this).data("time");
	            searchFunctions.displayPulse(teleonomeName, pulseMillis);
	        });
    
    
    		$(document).on('click', "#RefreshCounter",function(e) {
            	refreshCounterStatus=!refreshCounterStatus;
            	if(refreshCounterStatus){
            		refreshCounterStatus=false;
            	}else{
            		refreshCounterStatus=true;
            	}
            	
        	});    
    
    		$(document).on('click', "#GetDataSubmit",function(e) {
		        e.preventDefault();
		
		        $('#WaitingText').html("Please wait...");
		        $('#WaitingWheel').show();
		        
		       
		        var visualizationStyle = $('#VisualisationType').find(":selected").val();
		        var identityPointer = document.getElementById("Identity").value;
		        var fromDate = document.getElementById("fromDate").value;
		        var fromTime = document.getElementById("fromTime").value;
		        var fromMillis = (new Date(fromDate + " " + fromTime)).getTime();
		        var untilDate = document.getElementById("untilDate").value;
		        var untilTime = document.getElementById("untilTime").value;
		        var untilMillis = (new Date(untilDate + " " + untilTime)).getTime();
		        var formName="RememberDeneWord";
				var appendChart = $("#AppendChart").is(':checked');
				liveUpdate = $("#LiveUpdate").is(':checked');

		        if(fromDate=="" || fromTime==""){
					var date = new Date();
					var fromDate = (date.getDate()-1) + "/" + (date.getMonth()+1) + "/" + date.getFullYear();
					var fromTime = date.getHours() + ":" + date.getMinutes();
					
		            var ts = Math.round(date.getTime() / 1000);
		            fromMillis = ts - (24 * 3600);
		            //fromDate.setDate(fromDate.getDate()-1);
		            //fromMillis = fromDate.getTime();
		        }
		        if(untilDate=="" || untilTime==""){
					
					var date = new Date();
					untilMillis = date.getTime();
					var untilDate = date.getDate() + "/" + date.getMonth() + "/" + date.getFullYear();
					var untilTime = date.getHours() + ":" + date.getMinutes();
					
		        }else{
					//
					// if untildate is not blank, then is not a live update
					liveUpdate=false;
				}
		
		       
		        if(identityPointer=="" || identityPointer == undefined){
		            var selectedTeleonome = $('#Teleonome').find(":selected").val();
		            var selectedNucleus = $('#Nucleus').find(":selected").val();
		            var selecteDeneChain = $('#DeneChain').find(":selected").val();
		            var selecteDene = $('#Dene').find(":selected").val();
		            var selecteDeneWord = $('#DeneWord').find(":selected").val();
		            identityPointer = selectedTeleonome + ":" + selectedNucleus + ":" + selecteDeneChain + ":" + selecteDene + ":" + selecteDeneWord;
					formName="LookUpDeneWord";
					
					alert("Please select a remembered deneword");
					return false;
		        }
		            
		        
		        
		        var localStoreageKey = identityPointer + "_" + visualizationStyle+"_" + liveUpdate  + "_" + fromMillis + "_" + untilMillis;
		        
		        if(localStorageManager.getItem(localStoreageKey) != undefined){
		            alert("Visualizer exists");
		            return false; 
		        }
		        var searchObject = JSON.parse(localStorageManager.getItem(localStorageSearchKey));
		        if(searchObject == null || searchObject==undefined){
		            searchObject={};
		        }
		        
		       var numberOfObjects =  localStorageManager.getNumberOfObjectsByComponent(localStorageSearchKey)+1;
		
		        var identity = identityFactory.createIdentityByPointer(identityPointer);
		        
		        var anyTeleonomeName = identity.teleonomeName;
				var chartTitle = anyTeleonomeName + "-" + identity.deneWordName + " " + fromDate + " " + fromTime + "  -  " + untilDate + " " + untilTime;
				var chartDivId = anyTeleonomeName +  identity.deneWordName  + fromDate  + fromTime + untilDate  + untilTime;
				 chartDivId = chartDivId.replace(/\s/g, '');
				 chartDivId = chartDivId.replace(/-/g, '')
				 chartDivId = chartDivId.replace(/:/g, "");
				 chartDivId = chartDivId.replace(/\//g, "");
		        var jsonData = {
		            visualizationStyle:visualizationStyle,
		            identityPointer:identityPointer,
		            formName:formName,
		            appendChart:appendChart,
		            liveUpdate:liveUpdate,
					chartTitle:chartTitle,
					chartDivId:chartDivId,
		            fromMillis:fromMillis,
		            untilMillis:untilMillis,
		            position:numberOfObjects
		        }
		        var s = JSON.stringify(jsonData);
		        searchObject[localStoreageKey]=s;
		        
		        localStorageManager.setItem(localStorageSearchKey, searchObject);
				//searchFunctions.processForm(formName,identityPointer, fromMillis , untilMillis, appendChart, visualizationStyle, liveUpdate);
				searchFunctions.refreshSearchPage();
		        $('#WaitingWheel').hide();
		        $("#SearchConfigurator").hide();
		        $("#TopButtons").show();
		        $("#UpdateArea").show();
		        refreshCounterStatus=true;
		        $("#RefreshCounter").show();
 	            $("#RefreshCounterMessage").show();
		    });
            //
            // the end of searchpanel
            //
			$(document).on('click', '#RebootButton',function(e){
				e.preventDefault();
				var confirm = confirmNetworkingMessage( 'Are you sure you want to reboot the Teleonome?') ;
				if(!confirm)return false;

				var commandCode = prompt("Please enter the code", "");
				if(isNaN(commandCode) || commandCode.length!=6){
					alert("The code must be 6 numbers");
					return false;
				}
				var currentIdentityModePointer = "@" +teleonomeName + ":" + NUCLEI_PURPOSE + ":" +DENECHAIN_OPERATIONAL_DATA + ":" + DENE_TYPE_VITAL + ":" +DENEWORD_TYPE_CURRENT_IDENTITY_MODE;
				var currentIdentityMode = getDeneWordByIdentityPointer(currentIdentityModePointer, DENEWORD_VALUE_ATTRIBUTE);
				
				var formName = $('#formName').val();
				var action = "Reboot";

				if(currentIdentityMode == TELEONOME_IDENTITY_SELF){
					var enableNetworkMode = $('#EnableNetworkMode').val();
					var AvailableNetworks = $('#AvailableNetworks');
					var password = $('#password').val();
					$.ajax({
						type: "POST",
						url: "/TeleonomeServlet",
						data: {formName:formName, EnableNetworkMode: enableNetworkMode, action:action, password:password, CommandCode:commandCode},
						success: function (commandId) {
							console.log("commandId=" + data);
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	
				}else {	
					var enableHostMode = $('#EnableHostMode').val();
					$.ajax({
					type: "POST",
					url: "/TeleonomeServlet",
					data: {formName:formName, EnableHostMode: enableHostMode, action:action, CommandCode:commandCode},
					success: function (data) {
						console.log("error getting log file:" + data);
						var response = JSON.parse(data);
						//
						// the response contains the id, and the status, which 
						// at this point should be COMMAND_REQUEST_PENDING_EXECUTION
						// put it on the table
						$('#SettingsWorkArea').empty();
						var createdOnDate = new Date(response.Createdon);
						var formatedDate = getISOStringWithoutSecsAndMillisecs(createdOnDate);
						var panelHTML = "<table class=\"table text-center\">";
						panelHTML += "<thead><tr class=\"text-center\"><th>Id</th><th>Created On</th><th>ExecutedOn</th><th>Command</th><th>Status</th></tr></thead>";
						panelHTML += "<tbody><tr class=\"warning\"><td>"+response.id+"</td><td>"+ formatedDate +"</td><td></td><td>" + response.Command +"</td><td>" + response.Status +"</td></tr></tbody>";
						panelHTML += "</table>";
						$('#SettingsWorkArea').append(panelHTML);
			
					},
					error: function(data){
						console.log("error rebooting:" + data);
						alert("Error rebooting:" +  data);
						return false;
					}
				});	
				}	
			});

				$(document).on('click', '#Wifi',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new Networking(panelPointer);
					var html = n.process(panelPointer);
					
					$('#SettingsWorkArea').html(html);
					$(".BSswitch").bootstrapSwitch();
					$('#SettingsWorkArea').show();
				});
				$(document).on('click', '#UpdateParams',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new UpdateParams();
					var html = n.process(panelPointer);
					$('#SettingsWorkArea').html(html);
					$('#SettingsWorkArea').show();
				});
				$(document).on('click', '#DeviceInfo',function(e){
					var panelPointer  = $(this).data("panelpointer");
					var n = new DeviceInfo();
					var html = n.process();
					$('#SettingsWorkArea').html(html);
					$('#SettingsWorkArea').show();
				});
				$(document).on('click', '.UpdateParamBtn',function(e){
					 // e.preventDefault();
					  var source = event.target || event.srcElement;
					  
					  var passwd = prompt("Please enter the password", "");
					  if(isNaN(passwd)){
						alert("Password must be 6 numbers");
						  return false;
					  }
					  if(passwd.length!=6){
						  alert("Password must be 6 numbers");
						  return false;
					  }
					  $(source).prop('disabled', true);
					  $(source).text('Pending');
					  var data = $.parseJSON($(this).attr('data-form'));
					  var field = data.field;
					 $("#"+field + "Label").css('color', 'red');

					 var selected=""; 
					try{
					 var selectedField = $('#' + field);
					   selected = $('#' + field).val();
					   $(selected).prop('disabled', true);
					}catch(err){
					    console.log("error=" + err);
					}

					$.ajax({
						type: "GET",
						url: "/TeleonomeServlet",
						data: {formName:HEART_TOPIC_UPDATE_FORM_REQUEST, TELEONOME_IDENTITY_LABEL: data.identity, DENEWORD_VALUE_ATTRIBUTE: selected, COMMAND_REQUEST_PASSWORD : passwd },
						success: function (commandIddata) {
							console.log("commandId=" + data);
							
						},
						error: function(data){
							console.log("error getting log file:" + JSON.stringify(data));
							alert("Error getting log:" + JSON.stringify(data));
							return false;
						}
					});	

					//  var jsonData = {};
					//  jsonData[TELEONOME_IDENTITY_LABEL] = data.identity;
					//  jsonData[DENEWORD_VALUE_ATTRIBUTE] = selected;
					//  jsonData[COMMAND_REQUEST_PASSWORD] = passwd;
					// var message = new Paho.MQTT.Message(JSON.stringify(jsonData));
					// message.destinationName = HEART_TOPIC_UPDATE_FORM_REQUEST;
					// mqtt.send(message);
					  
					//message.setPayload(jsonData.getBytes());
					//mqtt.publish(HEART_TOPIC_UPDATE_FORM_REQUEST, message);
					 
					 // alert(field + " " + data.identity + " " + selected);
					});
				
				
			});
			
			
			function confirmNetworkingMessage( mensaje) {
				 //
				 // check we are enabling network mode
				 var enabledNetworkMode = $("#EnableNetworkMode").is(':checked');
				 if(enabledNetworkMode){
					 //
					 // now check that you have a value for SSID 
					 // and if needed a password
					 if($("#AvailableNetworks :selected")==null || ("#AvailableNetworks :selected")==""){
						 alert("Please select a SSID");
							return false;
					 }
					 var selectedSSID = $("#AvailableNetworks :selected").val();
					 if(selectedSSID!=""){
						 var selectedValue = $("#AvailableNetworks :selected").text();
						 var password =  $("#password").val().length>7;
						 
							if(selectedValue!=null && 
							  selectedValue.indexOf("Password")>-1 &&
							  !password
							){
								alert("Please input SSID password");
								return false;
							}
					 }else{
						 alert("Select an SSID");
						 return false;
					 }
					 
				 }
				 var answer = confirm(mensaje);
				 return answer;
				 
			}
		</script>

		<!-- Placed at the end of the document so the pages load faster -->
</body>
</html>
